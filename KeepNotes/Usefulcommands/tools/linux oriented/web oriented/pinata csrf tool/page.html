<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Pinata: CSRF tool</title>
</head><body>https://code.google.com/archive/p/pinata-csrf-tool/ <br/>
<br/>
Pinata is a Python Script that will generate Proof of Concept CSRF HTML from HTTP request.<br/>
<br/>
Overview:<br/>
-WARNING - THIS IS NOT A POINT AND CLICK TOOL. YOU SHOULD KNOW WHAT YOU ARE DOING TO USE THIS TOOL.<br/>
<br/>
The tool will generate proof of concept CSRF HTML given an HTTP request. It will automatically check whether it is a GET or a POST request and with further validation for standard POST and Multipart/form POST.<br/>
<br/>
The tool will then create an HTML corresponding to the type of the request.<br/>
<br/>
The GET CSRF HTML includes IMG tag with SRC set to the URL being tested.<br/>
<br/>
The POST CSRF HTML is created with auto submit java script form with names and values from the HTTP request.<br/>
<br/>
Working:<br/>
Pinata - Version 0.93 Out Now.<br/>
<br/>
Download pinata.zip from the downloads.<br/>
<br/>
It is Python based tool. Needs Python installed – I have developed it on Python 2.6. But it should work with Python 2.7.<br/>
<br/>
The tool consists of three files, piñata.py, markup.py and CSRFBody.txt.<br/>
<br/>
To install it create a new directory like C:\Pinata and copy all three files to it.<br/>
<br/>
Piñata.py is the main file and should be run to generate the HTML.<br/>
<br/>
Markup.py is called by piñata.py to generate HTML, I did not develop it and do not take any credit for it - however I would like to thank the developer, it made much easier to write this tool.<br/>
<br/>
CSRFBody.txt holds the HTTP request.<br/>
<br/>
To use the tool go to a vulnerable page, create a request, capturing the HTTP request in the proxy. Copy this request and paste it in CSRFBody.txt, saving and closing CSRFBody.txt<br/>
<br/>
Run the tool by going to command line and typing C:\Pinata\pinata.py<br/>
<br/>
It should generate the HTML file in C:\Pinata\<br/>
<br/>
Demonstration can be found here on my blog.<br/>
<br/>
http://secmir.blogspot.com/2010/05/csrf-demo-video.html<br/>
<br/>
Future Directions:<br/>
I look forward to your suggestions.<br/>
<br/>
Perhaps some features to beat referer header based CSRF protection.<br/>
<br/>
This is essentially a hack so I will work towards cleaning up the current code.<br/>
<br/>
Questions:<br/>
Let me know if you have any questions or it suddenly stops working for you.<br/>
ahsanmir (at)gmail (dot) com</body></html>