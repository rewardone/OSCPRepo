<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>CWDIllegalInDllSearch</title>
</head><body><br/>
<b>CWDIllegalInDllSearch</b>&nbsp; (Read <a href="http://www.greyhathacker.net/?p=235">more</a>)<br/>
Once the patch is installed (if applicable) you will need to add the DWORD name CWDIllegalInDllSearch with a value in the registry key location<br/>
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager] &nbsp;<br/>
<br/>
The value data can be 1, 2 or ffffffff. If the value name CWDIllegalInDllSearch does not exist or the value data is 0 then the machine will still be vulnerable to CWD attack. Please be aware that the value ffffffff could break certain applications. The search order is the same but this time if a malicious DLL is located in the current working directory the library is not loaded.<br/>
<ul><li style="list-style-type: none">1 The directory from which the application loaded</li>
<li style="list-style-type: none">2 32-bit System directory (C:\Windows\System32)</li>
<li style="list-style-type: none">3 16-bit System directory (C:\Windows\System)</li>
<li style="list-style-type: none">4 Windows directory (C:\Windows)</li>
<li style="list-style-type: none">5 The current working directory (CWD) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[ dlls not loaded ]</li>
</ul>
<br/>
6 Directories in the PATH environment variable (system then user)</body></html>