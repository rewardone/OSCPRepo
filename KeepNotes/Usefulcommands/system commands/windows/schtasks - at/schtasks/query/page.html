<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Query</title>
</head><body>schtasks query<br/>
Displays tasks scheduled to run on the computer.<br/>
<br/>
Syntax<br/>
Schtasks [/query] [/fo {TABLE | LIST | CSV}] [/nh] [/v] [/s Computer [/u [Domain**\]User [/p** Password]]]<br/>
<br/>
Parameters<br/>
[/query]<br/>
The operation name is optional. Typing schtasks without any parameters performs a query.<br/>
/fo {TABLE| LIST| CSV}<br/>
Specifies the output format. TABLE is the default.<br/>
/nh<br/>
Omits column headings from the table display. This parameter is valid with the TABLE and CSV output formats.<br/>
/v<br/>
Adds advanced properties of the tasks to the display.<br/>
<br/>
Copy<br/>
Queries using **/v** should be formatted as **LIST** or **CSV**.<br/>
/s Computer<br/>
Specifies the name or IP address of a remote computer (with or without backslashes). The default is the local computer.<br/>
/u [Domain\]User<br/>
Runs this command with the permissions of the specified user account. By default, the command runs with the permissions of the current user of the local computer.<br/>
<br/>
Copy<br/>
The specified user account must be a member of the Administrators group on the remote computer. The **/u** and **/p** parameters are valid only when you use **/s**.<br/>
/p Password<br/>
Specifies the password of the user account specified in the /u parameter. If you use /u, but omit /p or the password argument, Schtasks prompts you for a password.<br/>
<br/>
Copy<br/>
The **/u** and **/p** parameters are valid only when you use **/s**.<br/>
/?<br/>
Displays help at the command prompt.<br/>
Remarks<br/>
The query operation lists all tasks that the user has permission to view. Administrators can view all tasks on the computer. Users can view only the tasks that they scheduled.<br/>
Examples<br/>
To display the scheduled tasks on the local computer<br/>
The following commands display all tasks scheduled for the local computer. These commands produce the same result and can be used interchangeably.<br/>
<br/>
schtasks<br/>
<br/>
schtasks /query<br/>
<br/>
In response, SchTasks.exe displays the tasks in the default, simple table format, as shown in the following table:<br/>
<br/>
<br/>
Copy<br/>
TaskName &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Next Run Time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Status<br/>
========================= ======================== ==============<br/>
Microsoft Outlook &nbsp; &nbsp; &nbsp; &nbsp; At logon time &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br/>
SecureScript &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;14:42:00 PM , 2/4/2001 &nbsp; <br/>
To display advanced properties of scheduled tasks<br/>
The following command requests a detailed display of the tasks on the local computer. It uses the /v parameter to request a detailed (verbose) display and the /fo LIST parameter to format the display as a list for easy reading. You can use this command to verify that a task you created has the intended recurrence pattern.<br/>
<br/>
schtasks /query /fo LIST /v<br/>
<br/>
In response, SchTasks.exe displays a detailed property list for all tasks. The following display shows the task list for a task scheduled to run at 4:00 A.M. on the last Friday of every month:<br/>
<br/>
<br/>
Copy<br/>
HostName: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RESKIT01<br/>
TaskName: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecureScript<br/>
Next Run Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4:00:00 AM , 3/30/2001<br/>
Status: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Not yet run<br/>
Logon mode: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Interactive/Background<br/>
Last Run Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Never<br/>
Last Result: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0<br/>
Creator: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; user01<br/>
Schedule: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;At 4:00 AM on the last Fri of every month, starting 3/24/2001<br/>
Task To Run: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; C:\WINDOWS\system32\notepad.exe<br/>
Start In: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;notepad.exe<br/>
Comment: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; N/A<br/>
Scheduled Task State: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Enabled<br/>
Scheduled Type: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Monthly<br/>
Modifier: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Last FRIDAY<br/>
Start Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;4:00:00 AM<br/>
Start Date: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3/24/2001<br/>
End Date: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;N/A<br/>
Days: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;FRIDAY<br/>
Months: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;JAN,FEB,MAR,APR,MAY,JUN,JUL,AUG,SEP,OCT,NOV,DEC<br/>
Run As User: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RESKIT\user01<br/>
Delete Task If Not Rescheduled: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Enabled<br/>
Stop Task If Runs X Hours and X Mins: &nbsp; &nbsp; &nbsp;72:0<br/>
Repeat: Until Time: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Disabled<br/>
Repeat: Duration: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Disabled<br/>
Repeat: Stop If Still Running: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Disabled<br/>
Idle: Start Time(For IDLE Scheduled Type): Disabled<br/>
Idle: Only Start If Idle for X Minutes: &nbsp; &nbsp;Disabled<br/>
Idle: If Not Idle Retry For X Minutes: &nbsp; &nbsp; Disabled<br/>
Idle: Stop Task If Idle State End: &nbsp; &nbsp; &nbsp; &nbsp; Disabled<br/>
Power Mgmt: No Start On Batteries: &nbsp; &nbsp; &nbsp; &nbsp; Disabled<br/>
Power Mgmt: Stop On Battery Mode: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Disabled<br/>
To log tasks scheduled for a remote computer<br/>
The following command requests a list of tasks scheduled for a remote computer, and adds the tasks to a comma-separated log file on the local computer. You can use this command format to collect and track tasks that are scheduled for multiple computers.<br/>
<br/>
The command uses the /s parameter to identify the remote computer, Reskit16, the /fo parameter to specify the format and the /nh parameter to suppress the column headings. The &gt;&gt; append symbol redirects the output to the task log, p0102.csv, on the local computer, Svr01. Because the command runs on the remote computer, the local computer path must be fully qualified.<br/>
<br/>
schtasks /query /s Reskit16 /fo csv /nh &gt;&gt; \\svr01\data\tasklogs\p0102.csv<br/>
<br/>
In response, SchTasks.exe adds the tasks scheduled for the Reskit16 computer to the p0102.csv file on the local computer, Svr01.<br/>
<br/>
Remarks<br/>
This help file describes the version of Schtasks.exe included in the Windows Server™ 2003 family. For information about the version of Schtasks.exe in Windows XP Professional, see the Schtasks topic in Windows XP Professional Help.<br/>
<br/>
SchTasks.exe performs the same operations as Scheduled Tasks in Control Panel. You can use these tools together and interchangeably.<br/>
<br/>
Schtasks replaces At.exe, a tool included in previous versions of Windows. Although At.exe is still included in the Windows Server™ 2003 family, Schtasks is the recommended command-line task scheduling tool.<br/>
<br/>
The parameters in a Schtasks command can appear in any order. Typing schtasks without any parameters performs a query.<br/>
<br/>
Permissions for Schtasks<br/>
<br/>
You must have permission to run the command. Any user can schedule a task on the local computer, and they can view and change the tasks that they scheduled. Members of the Administrators group can schedule, view, and change all tasks on the local computer.<br/>
<br/>
To schedule, view, or change a task on a remote computer, you must be member of the Administrators group on the remote computer, or you must use the /u parameter to provide the credentials of an Administrator of the remote computer.<br/>
<br/>
You can use the /u parameter in a /create or /change operation only when the local and remote computers are in the same domain or the local computer is in a domain that the remote computer domain trusts. Otherwise, the remote computer cannot authenticate the user account specified and it cannot verify that the account is a member of the Administrators group.<br/>
<br/>
The task must have permission to run. The permissions required vary with the task. By default, tasks run with the permissions of the current user of the local computer, or with the permissions of the user specified by the /u parameter, if one is included. To run a task with permissions of a different user account or with system permissions, use the /ru parameter.<br/>
<br/>
To verify that a scheduled task ran or to find out why a scheduled task did not run, see the Task Scheduler service transaction log, Systemroot\SchedLgU.txt. This log records attempted runs initiated by all tools that use the service, including Scheduled Tasks and SchTasks.exe.<br/>
<br/>
On rare occasions, task files become corrupted. Corrupted tasks do not run. When you try to perform an operation on corrupted tasks, SchTasks.exe displays the following error message:<br/>
<br/>
<br/>
Copy<br/>
ERROR: The data is invalid.<br/>
You cannot recover corrupted tasks. To restore the task scheduling features of the system, use SchTasks.exe or Scheduled Tasks to delete the tasks from the system and reschedule them.</body></html>