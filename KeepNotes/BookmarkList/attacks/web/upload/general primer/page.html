<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General primer</title>
</head><body>Uploading files gives an attacker a lot of things, or at least the potential for a lot of things. Here are tips tricks to evade upload filtering and potential vectors. <br/>
<br/>
Risk Factors<ul><li>The impact of this vulnerability is high, supposed code can be executed in the server context or on the client side. The likelihood of detection for the attacker is high. The prevalence is common. As a result the severity of this type of vulnerability is high.</li>
<li>Server-side attacks: The web server can be compromised by uploading and executing a web-shell which can run commands, browse system files, browse local resources, attack other servers, or exploit the local vulnerabilities, and so forth.</li>
<li>Client-side attacks: Uploading malicious files can make the website vulnerable to client-side attacks such as XSS or Cross-site Content Hijacking.</li>
<li>Uploaded files can be abused to exploit other vulnerable sections of an application when a file on the same or a trusted server is needed (can again lead to client-side or server-side attacks)</li>
<li>Uploaded files might trigger vulnerabilities in broken libraries/applications on the client side (e.g. iPhone MobileSafari LibTIFF Buffer Overflow).</li>
<li>Uploaded files might trigger vulnerabilities in broken libraries/applications on the server side (e.g. ImageMagick flaw that called ImageTragick!).</li>
<li>Uploaded files might trigger vulnerabilities in broken real-time monitoring tools (e.g. Symantec antivirus exploit by unpacking a RAR file)</li>
<li>A malicious file such as a Unix shell script, a windows virus, an Excel file with a dangerous formula, or a reverse shell can be uploaded on the server in order to execute code by an administrator or webmaster later -- on the victim's machine.</li>
<li>An attacker might be able to put a phishing page into the website or deface the website.</li>
<li>The file storage server might be abused to host troublesome files including malwares, illegal software, or adult contents. Uploaded files might also contain malwares' command and control data, violence and harassment messages, or steganographic data that can be used by criminal organisations.</li>
<li>Uploaded sensitive files might be accessible by unauthorised people.</li>
<li>File uploaders may disclose internal information such as server internal paths in their error messages.</li>
</ul>
<br/>
<b>Examples</b><br/>
Attacks on application platform<ul><li>Upload .jsp file into web tree - jsp code executed as the web user</li>
<li>Upload .gif file to be resized - image library flaw exploited</li>
<li>Upload huge files - file space denial of service</li>
<li>Upload file using malicious path or name - overwrite a critical file</li>
<li>Upload file containing personal data - other users access it</li>
<li>Upload file containing "tags" - tags get executed as part of being "included" in a web page</li>
<li>Upload .rar file to be scanned by antivirus - command executed on a server running the vulnerable antivirus software</li>
</ul>
<br/>
<b>Attacks on other systems</b><ul><li>Upload .exe file into web tree - victims download trojaned executable</li>
<li>Upload virus infected file - victims' machines infected</li>
<li>Upload .html file containing script - victim experiences Cross-site Scripting (XSS)</li>
<li>Upload .jpg file containing a Flash object - victim experiences Cross-site Content Hijacking.</li>
<li>Upload .rar file to be scanned by antivirus - command executed on a client running the vulnerable antivirus software</li>
</ul>
</body></html>