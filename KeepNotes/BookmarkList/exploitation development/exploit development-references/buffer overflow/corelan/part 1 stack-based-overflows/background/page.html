<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Background</title>
</head><body>Background:<br/>
Part 1 revolves around exploiting a copy of Easy RM to MP3 on Windows XP SP3. The application will crash when presented with a bad .m3u file. <br/>
<br/>
Confirming the Crash<br/>
We’ll use the following simple perl script to create a .m3u file that may help us to discover more information about the vulnerability :<br/>
<br/>
my $file= "crash.m3u";<br/>
my $junk= "\x41" x 30000; #\x41 is hex representation of 'A'<br/>
open($FILE,"&gt;$file");<br/>
print $FILE "$junk";<br/>
close($FILE);<br/>
print "m3u File Created successfully\n";<br/>
<br/>
Boom – application dies.<br/>
Ok, so the application crashes if we feed it a file that contains between 20000 and 30000 A’s. But what can we do with this ?<br/>
Obviously, not every application crash can lead to an exploitation. In many cases, an application crash will not lead to exploitation… But sometimes it does.<br/>
<br/>
The easiest way to make an application do something different is by controlling its application flow (and redirect it to somewhere else). This can be done by controlling the <a href="http://en.wikipedia.org/wiki/X86_assembly_language">Instruction Pointer</a>&nbsp;(or Program Counter), which is a CPU register that contains a pointer to where the next instruction that needs to be executed is located.<br/>
&nbsp;<br/>
Suppose an application calls a function with a parameter. Before going to the function, it saves the current location in the instruction pointer (so it knows where to return when the function completes). If you can modify the value in this pointer, and point it to a location in memory that contains your own piece of code, then you can change the application flow and make it execute something different (other than returning back to the original place). The code that you want to be executed after controlling the flow is often referred to as “shellcode”. So if we make the application run our shellcode, we can call it a working exploit. In most cases, this pointer is referenced by the term EIP. This register size is 4 bytes. So if you can modify those 4 bytes, you own the application (and the computer the application runs on).<br/>
<br/>
<br/>
</body></html>