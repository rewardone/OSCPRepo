<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Hardcoded Jumps</title>
</head><body>Another (less preferred, but still possible) way to jump to shellcode is by using jumpcode that simply jumps to the address (or an offset of a register). Since the addresses/registers could vary during every program execution, this technique may not work every time.<br/>
<br/>
So, in order to hardcode addresses or offsets of a register, you simply need to find the opcode that will do the jump, and then use that opcode in the smaller “first”/stage1 buffer, in order to jump to the real shellcode.<br/>
<br/>
You should know by now how to find the opcode for assembler instructions, so I’ll stick to 2 examples :<br/>
<br/>
1. jump to 0x12345678<br/>
<br/>
0:000&gt; a<br/>
7c90120e jmp 12345678<br/>
jmp 12345678<br/>
7c901213 <br/>
<br/>
0:000&gt; u 7c90120e<br/>
ntdll!DbgBreakPoint:<br/>
7c90120e e96544a495 &nbsp; &nbsp; &nbsp;jmp &nbsp; &nbsp; 12345678<br/>
<br/>
=&gt; opcode is 0xe9,0x65,0x44,0xa4,0x95<br/>
<br/>
2. jump to ebx+124h<br/>
<br/>
0:000&gt; a<br/>
7c901214 add ebx,124<br/>
add ebx,124<br/>
7c90121a jmp ebx<br/>
jmp ebx<br/>
7c90121c <br/>
<br/>
0:000&gt; u 7c901214<br/>
ntdll!DbgUserBreakPoint+0x2:<br/>
7c901214 81c324010000 &nbsp; &nbsp;add &nbsp; &nbsp; ebx,124h<br/>
7c90121a ffe3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;jmp &nbsp; &nbsp; ebx<br/>
<br/>
=&gt; opcodes are 0x81,0xc3,0x24,0x01,0x00,0x00 (add ebx 124h) and 0xff,0xe3 (jmp ebx)</body></html>