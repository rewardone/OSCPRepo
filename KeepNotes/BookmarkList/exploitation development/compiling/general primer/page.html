<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>Compiling for Windows using mingw<br/>
<br/>
The idea is simple:<br/>
&nbsp;<ul><li>&nbsp;Install 64-bit MinGW.</li>
<li>Create a directory where we will perform all cross-compilations.</li>
<li>Get all the necessary sources.</li>
<li>Cross-compile everything.</li>
</ul>
<br/>
<b>Installing the prerequisites for cross-compilation </b><br/>
&nbsp;sudo apt-get install mingw-w64 git-core wget quilt sudo apt-get build-dep tinc &nbsp;<br/>
<br/>
Other Linux distributions may also have 64-bit MinGW packages, use their respective package management tools to install them. Debian installs the cross-compiler in /usr/x86_64-w64-mingw32/. Other distributions might install it in another directory however. Check in which directory it is installed, and replace all occurences of x86_64-w64-mingw32 in this example with the correct name from your distribution.<br/>
<br/>
<b>Setting up the build directory and getting the sources</b><br/>
We will create a directory called mingw64/ in the home directory. We use apt-get and wget to get the required libraries necessary for tinc, and use git to get the latest development version of tinc.<br/>
<br/>
mkdir $HOME/mingw64<br/>
cd $HOME/mingw64<br/>
apt-get source liblzo2-dev zlib1g-dev libssl-dev<br/>
git clone git://tinc-vpn.org/tinc<br/>
<br/>
<b>Making cross-compilation easy</b><br/>
To make cross-compiling easy, we create a script called mingw64 that will set up the necessary environment variables so configure scripts and Makefiles will use the 64-bit MinGW version of GCC and binutils:<br/>
<br/>
mkdir $HOME/bin<br/>
cat &gt;$HOME/bin/mingw64 &lt;&lt; 'EOF'<br/>
#!/bin/sh<br/>
PREFIX=x86_64-w64-mingw32<br/>
export CC=$PREFIX-gcc<br/>
export CXX=$PREFIX-g++<br/>
export CPP=$PREFIX-cpp<br/>
export RANLIB=$PREFIX-ranlib<br/>
export PATH="/usr/x86_64-w64-mingw32/bin:$PATH"<br/>
exec "$@"<br/>
EOF<br/>
chmod u+x $HOME/bin/mingw64<br/>
<br/>
If $HOME/bin is not already part of your $PATH, you need to add it:<br/>
export PATH="$HOME/bin:$PATH"<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
We use this script to call ./configure and make with the right environment variables, but only when the ./configure script doesnâ€™t support cross-compilation itself. You can also run the export commands from the mingw64 script by hand instead of calling the mingw64 script for every ./configure or make command, or execute $HOME/bin/mingw64 $SHELL to get a shell with these environment variables set, but in this howto we will call it explicitly every time it is needed.<br/>
<br/>
<br/>
<br/>
This isn't a silver bullet, but rather a quick way to get a Windows build of platform independent code that you might already have running in Linux. I've found that this approach makes it easy to get binaries out the door in a hurry when it's hard to get a project building with Visual Studio or even on the Windows platform itself (due to, say, a complex build system).</body></html>