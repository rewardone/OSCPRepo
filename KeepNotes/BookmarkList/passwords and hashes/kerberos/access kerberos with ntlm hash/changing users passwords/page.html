<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Changing User's Passwords</title>
</head><body>The dire consequence? Attackers can use the stolen NTLM hash to change the victim’s password to one of their choice.<div style="text-align: center"><div style="text-align: left"><br/>
</div></div><div style="text-align: center"><div style="text-align: left"><br/>
</div></div>Technically, the password change functionality is achieved by supplementing Active Directory’s regular authentication module (named “Krbtgt”) with a dedicated module that handles authentication requests for password changes (named “Kadmin”). Kadmin module is very similar in operation to the Krbtgt module and most importantly to our case, uses the same Kerberos logic and hence is exposed to the same flaws.<br/>
<br/>
As a result, using the above techniques of using an NTLM hash as the RC4-HMAC key for Kerberos authentication against Active Directory’s Kadmin module, attackers are able to change the password of their victim to an arbitrary password of their choice.<br/>
<br/>
In fact, we had validated this behavior with a Proof-of-Concept tool we had built.<br/>
</body></html>