<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>RDP Session Hijack</title>
</head><body>Did you know you can also hijack a session without the user password?<br/>
You can right click a user in Task Manager, use tsadmin.msc, or use the command tscon.exe. <ul><li>If you run tscon.exe as the SYSTEM user, you can connect to any session without a password. It doesn’t prompt, it just connects you to the user’s desktop.</li>
</ul>
<br/>
Some parameters about how far this reaches<ul><li>You can connect to disconnected sessions. So if somebody logged out 3 days ago, you can just connect straight to their session and start using it.</li>
<li>It unlocks locked sessions. So if a user is away from their desk, you steal their session AND it unlocks the ‘workstation’ without needing any credentials.</li>
<li>It works for the physical console. So you can hijack the screen remotely. It also unlocks the physical console, too.</li>
</ul>
<br/>
You can connect to ANY session <ul><li>There are no external tools. Nothing to get through application whitelisting. No executable is written to disk.</li>
<li>Unless you know what to monitor (more on that later), you won’t know this is happening.</li>
<li>It works remotely. You can take over sessions on remote computers, even if you’re not logged into that server.</li>
</ul>
<br/>
<br/>
Example session hijack:<br/>
#look for RPD in sessionname, and your ID<br/>
C:&gt; query user<br/>
C:&gt; sc create sessionhijack binpath= "cmd.exe /k tscon &lt;YOUR ID FROM ABOVE&gt; /dest:&lt;RDP SESSIONNAME FROM ABOVE&gt;<br/>
C:&gt; net start sessionhijack<br/>
<br/>
In essence it is really easy, just use the quser command to get the Session ID you want to hijack, and your own SESSIONNAME. Then run tscon with the Session ID for hijack, and your own SESSIONNAME. Your own Session will be replaced with the hijacked session. The service will run as SYSTEM by default — you’re in.<br/>
<br/>
<br/>
If you are SYSTEM, there is also a Mimikatz module for this. Set privilege to debug<br/>
# ts::sessions<br/>
# privilege::debug<br/>
# token::elevate<br/>
# ts::remote /id:&lt;session id&gt;</body></html>