<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>PSExec</title>
</head><body>https://pen-testing.sans.org/blog/2013/03/18/a-penetration-testers-pledge <br/>
<br/>
Just a note here that PSExec passes credentials in the clear when using the -u and -p options. <b>Please don't do it.</b>&nbsp;<br/>
<br/>
That being said, PSExec is one of the preferred methods of pivoting through a Windows environment once SMB credentials have been obtained. <br/>
<br/>
Regardless of the variant you use, psexec leverages your credentials to make an SMB connection to the target machine, writes into its file system some code you want to execute, creates a service on the box, and uses the service to execute your code. If you use the Metasploit or NSE versions of psexec, it then cleans up after itself, by deleting the service and removing the code from the file system (both the service and code have a pseudo-random name in Metasploit and NSE).<br/>
<br/>
Important note: the Microsoft Sysinternals psexec program doesn't remove the service that it creates. Thus, as a penetration tester, you'll either leave behind an installed service on the machine, or you'll need to remove it after you are done. I like to remove it, restoring the environment to what it was like before I was there, lest I slightly increase the attack service of the target machine by leaving behind the psexec service and its related code. You can remove it using the Microsoft service control (sc) command, as follows:<br/>
<br/>
C:\&gt; sc \&lt;RemoteTarget&gt; stop psexesvc<br/>
C:\&gt; del \&lt;RemoteTarget&gt;\admin$\psexesvc.exe<br/>
C:\&gt; del \&lt;RemoteTarget&gt;\admin$\system32\psexesvc.exe<br/>
C:\&gt; sc \&lt;RemoteTarget&gt; delete psexesvc</body></html>