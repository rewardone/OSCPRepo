<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>TCP Layer</title>
</head><body>Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) are two protocols that<br/>
operates on Transport layer. TCP offers a reliable end-to-end connection-oriented service (see Table 5 for covert<br/>
channel), and UDP offers a connectionless oriented service (see Table 6 for covert channel).<br/>
Rowland [98] implements Covert TCP by using 32-bit Initial Sequence Number (ISN) and Acknowledge Sequence<br/>
Number fields from TCP header. Rutkowska [99] has created a passive covert channel NUSHU (based on<br/>
Covert TCP), which does not generate any additional traffic, but uses data of the existing one. NUSHU sender<br/>
modifies the Initial Sequence Number (ISN) and Acknowledge Sequence Number fields generated by OS. Murdoch<br/>
and Lewis [85] developed a robust scheme, Lathra, which generates ISNs for OpenBSD and Linux, that are almost<br/>
indistinguishable from those generated by a genuine TCP stack, except by wardens with knowledge of a shared<br/>
secret key.<br/>
Ahsan [3] presented covert storage channels by redundancy present in some combination of six flag bits (URG,<br/>
ACK, PSH, RST, SYN, FIN). From 64 possible combinations, 29 are valid. If the URG bit is not set, one can use<br/>
the TCP Urgent Pointer field for creating covert channel with 16 bits per packet [3, 45]. One can use Reserved<br/>
field for sending 4 bits per segment [4].<br/>
Giffin et al [42] presented a covert timing channel that uses TCP timestamps, by the modification of their low<br/>
order bit. This method slows the TCP stream so that the timestamps on segments are valid when they are sent.<br/>
1-bit-per-segment covert channel can be obtained by comparing the low order bit of every TCP timestamp with<br/>
the current message bit. If they match the segment is sent immediately with generated TCP timestamp, otherwise<br/>
it is delayed for one timestamp tick and TCP timestamp is incremented. On slow network this channel is hard<br/>
to detect because the low order bit of the timestamp appears randomly distributed.<br/>
Chakinala et al [21] extend the reordering scheme proposed in [2, 3] and create a timing covert channel by<br/>
reordering of TCP segments and using the Sequence Number field and suitably defined mathematical model.<br/>
Luo et al [71] implemented storage covert channel Clack by modification of the Acknowledge Sequence Number<br/>
field. Luo et al [72] implemented ACKLeaks covert channel which embeds covert messages into pure TCP ACK<br/>
packets from single or multiple TCP connections, using the combinatorial approach. ACKLeaks can evade contentbased<br/>
detection methods and can be implemented by exploiting the existing TCP connections. Cloak [69] is a new class of reliable timing covert channels, which encodes a message by a unique distribution of N packets over<br/>
X TCP flows with ten different encoding and decoding methods, and carefully crafted to mimic the normal TCP<br/>
flows. Sender can establish HTTP session with a remote server which consists of several TCP flows, or with<br/>
multiple servers. The warden could not detect Cloak simply based on the presence of multiple TCP flows to the<br/>
same server, because it is not uncommon to have multiple TCP flows in an HTTP session. In the second case,<br/>
the decoder should be located on the common routing path. TCP-Script [70] is another implementation of timing<br/>
covert channel, which embeds the message in the normal TCP data bursts, and exploits TCP’s feedback and<br/>
reliability service to increase the decoding accuracy. The message is represented by an array of positive integers<br/>
mi, where mi ∈ [1, M] and M is a constant pre-agreed by the encoder and decoder. Each mi is encoded by a burst<br/>
of mi back-to-back TCP data segments, send in the encoding period TE. Two adjacent data bursts are separated<br/>
by an appropriate time interval. This channel is robust against network jitter, packet loss and reordering, but<br/>
has very low capacity and it is easy to differentiate its traffic from legitimate traffic.<br/>
Mazurczyk et al [81, 82] apply RSTEG method to TCP by using all TCP retransmission mechanisms: RTO<br/>
(Retransmission Timeout), FR/R (Fast Retransmit/Recovery) and SACK (Selective ACK). The main idea behind<br/>
RSTEG is to not acknowledge a successfully received TCP segment in order to intentionally invoke retransmission.<br/>
The retransmitted segment carries a steganogram instead of user data in the payload field. The intentional<br/>
retransmissions due to RSTEG should be kept near normal network retransmission rate, to avoid detection.<br/>
Authors use hash function for marking covert segments. One limitation is the need of using normal network<br/>
retransmission rates for harder detection.<br/>
One covert channel in UDP can be created by presence or absence of the Checksum field in the datagram [34],<br/>
because this field is optional in UDP. This results in PRBR of 1 bit per datagram. Abad [1] method can be<br/>
applied to TCP and UDP Checksum field also. UDP offers 3 fields [112] for carrying secret data up to 6B: Source<br/>
address, Length and Checksum.</body></html>