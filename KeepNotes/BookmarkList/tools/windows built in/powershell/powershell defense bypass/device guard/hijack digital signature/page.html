<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Hijack Digital Signature</title>
</head><body>Hijacking digital signatures is a technique which can be used in order to bypass Device Guard restrictions and during red team assessments to hide custom malware. Matt Graeber in his research discovered how to bypass digital signature hash validation and he described everything in detail in the paper that he released. Based on this information the Digital SignatureHijack script was developed to fully automate this technique. Further information regarding hijacking digital signatures have been described in a previous article.<br/>
<br/>
General Information<br/>
DigitalSignatureHijack is based on PowerShell and can be executed from a PowerShell console with administrative privileges. The idea is to digitally sign PowerShell scripts and portable executables fast by executing &nbsp;only four commands in total.<br/>
<br/>
Digital Signature Hijack<br/>
Hijacking legitimate digital signatures is a technique that can be used during red team assessments in order to sign PowerShell code and binaries. This could assist to bypass Device Guard restrictions and maintain stealthy in an engagement. DigitalSignatureHijack is a PowerShell script based on <a href="https://github.com/mattifestation/">Matt Graeber</a> research that can perform the following operations:<br/>
<br/>
Digitally sign all portable executables on the host as Microsoft<br/>
Digitally sign all powershell scripts on the host as Microsoft<br/>
Validate the digital signature for all portable executables<br/>
Validate the digital signature for all powershell scripts<br/>
<br/>
This is achieved by hijacking the registry and adding the necessary values and by utilizing the custom SIP dll file that Matt Graeber developed. Users need to modify the path of MySIP.dll to their local path.<br/>
<ul><li><a href="https://github.com/netbiosX/Digital-Signature-Hijack/raw/master/Hijack-Certificates/MySIP.dll">MySIP.dll</a> - <a href="https://github.com/mattifestation/PoCSubjectInterfacePackage">https://github.com/mattifestation/PoCSubjectInterfacePackage</a></li>
</ul>
&nbsp;<br/>
Disclaimer<ul><li>The purpose of this repository is to store compiled DLL's, binaries, scripts and to centralize existing information about digital signature hijacking. All the credits are going to the original authors of these tools.</li>
<li>The binaries and the DLL which are stored in this repository have not been modified from their original state and they are totally safe. However if for any reason you don't trust this repository the original repositories which contain the source code of these tools are provided in order to compile them by yourself.</li>
</ul>
&nbsp;<br/>
#https://gist.github.com/netbiosX/fe5b13b4cc59f9a944fe40944920d07c<br/>
#https://github.com/netbiosX/Digital-Signature-Hijack<br/>
#https://github.com/mattifestation/PoCSubjectInterfacePackage</body></html>