<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>If you start cmstp.exe with no parameters you get this:<br/>
<br/>
<img src="image.png" /><br/>
<br/>
The strange thing is that this executable is not supposed to “auto elevate”.<br/>
Also, if we check the integrity level of the process we can confirm that it is not elevated by default and is running in medium integrity level<br/>
Using 'sendkeys', CMSTP can be automated. How about automated loading of an attacker profile?!<br/>
Microsoft have implemented security measures (<a href="https://en.wikipedia.org/wiki/User_Interface_Privilege_Isolation">UIPI</a>) in the past to prevent sendkey attacks so I am amazed that this works. I think it is a little cool at least<br/>
The reason is autoelevated COM interface CMLUAUTIL from cmlua.dll, it has ShellExec and some more methods which also maybe out of interest. I think you can just run methods from this interface directly without “sendkeys”<br/>
*CMSTPLUA/cmstplua.dll<br/>
</body></html>