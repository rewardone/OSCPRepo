<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WUSA.exe</title>
</head><body><b>Windows Update Standalone Installer</b><br/>
Another method to use to copy to our secure location is using Windows Update Standalone Installer (wusa.exe). Wusa.exe when executed runs as a high integrity process as its set to auto-elevate in its manifest. For auto-elevation the Windows executable must be signed, located in a secure directory such as C:\Windows\System32 and must specify the autoElevate property in their manifest. (You can use BinText to view an .exe manifest and search for &lt;autoElevate&gt; tag)<br/>
<br/>
We use wusa.exe to extract a CAB file (cabinet archive file) to our secure location<br/>
<br/>
wusa c:\users\user1\desktop\poc.tmp /extract:c:\windows\system32\sysprep<br/>
<br/>
Here in the example our cab file is called poc.tmp but we can call it whatever we like. Windows comes with the makecab.exe tool so we can even create our cab file<br/>
<br/>
makecab c:\users\user1\desktop\CRYPTBASE.dll c:\users\user1\desktop\poc.tmp<br/>
</body></html>