<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>This blog post is about what the TI group really is, and more importantly, with the aid of PowerShell and the NtObjectManager module, how you can be TI to do whatever you wanted to do.<br/>
<br/>
Where is TrustedInstaller?<br/>
If TI isn’t a user or group then what is it? Perhaps looking at the ACL more closely will give us some insight. You can use the Get-Acl cmdlet to read the security descriptor from a file and we can list the TI ACE.<br/>
The SID itself is generated on the fly as the SHA1 hash of the uppercase version of the service name. <br/>
<br/>
There’s a service called TrustedInstaller which must be running when system resources are modified. And that’s exactly what we find if we query with the SC utility. If we start the TI service and look at the Access Token we’ll see that it has the TI group enabled.</body></html>