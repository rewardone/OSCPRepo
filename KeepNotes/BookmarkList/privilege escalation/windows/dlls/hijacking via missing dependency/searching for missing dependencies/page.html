<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Searching For Missing Dependencies</title>
</head><body>Three popular options, PowerSploit modules, IDA, and <a href="https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx">Process Monitor/ProcMon</a>&nbsp;<br/>
<br/>
Pull the binary and .dll off of the target machine<br/>
Load into IDA<br/>
Search for "loadlibrary" to see what libraries are called<br/>
Search the system for the dll that will be loaded (ex wlbsctrl.dll) C:&gt;\ dir wlbsctrl.dll /s<br/>
<br/>
<br/>
<br/>
<br/>
Processes with Missing DLL’s<br/>
The first step is to list all the processes on the system and discover these processes which are running as SYSTEM and are missing DLL’s. This can be done just by using the process monitor tool from Sysinternals and by applying the filters below:<br/>
<br/>
<img src="image.png" /><br/>
<br/>
Process Monitor will identify if there is any DLL that the application tries to load and the actual path that the application is looking for the missing DLL.<br/>
<br/>
<img src="image 2.png" /><br/>
<br/>
In this example the process Bginfo.exe is missing several DLL files which possibly can be used for privilege escalation.<br/>
</body></html>