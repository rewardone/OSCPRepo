<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Hide Alternate Data Streams Behind Dot Space Names</title>
</head><body><img src="image.png" />There exists a second trick which can be used to hide from the tools. On Windows you can add “.&lt;spaces&gt;.” at the end of a file and Windows will automatically remove it (canonicalization removes it).<br/>
<br/>
<img src="image 2.png" /><br/>
<br/>
However, we can create such a file with an ADS! The funny property of such a file is that tools will not be able to open the file, because a path like “xyz. .” will automatically be changed to “xyz” and this file doesn’t exist.<br/>
<br/>
Here is the proof:<br/>
<br/>
<img src="image 3.png" /><br/>
<br/>
The created ADS foobar.txt can’t be found by the tools:<br/>
<br/>
<img src="image 4.png" /><br/>
<br/>
Side note 1: Such files can also be created via: echo test &gt; “test. .::$DATA”<br/>
<br/>
Side note 2: Please note that the “..:abc.txt” ADS is the ADS which was created on “C:\:abc.txt”.<br/>
<br/>
We can also create a directory with the name “. .” like this:<br/>
<br/>
<img src="image 5.png" /><br/>
<br/>
Then it’s not possible to enter this folder:<br/>
<br/>
<img src="image 6.png" /><br/>
<br/>
Moreover, the already mentioned technique (like cd . .\. .\ doesn’t work), but cd “. .::$INDEX_ALLOCATION” works (the double quotes are important).<br/>
<br/>
If we can add spaces in between of a directory name, we can also add it at the end like “b ” or “.. ” or “. “.<br/>
<br/>
<img src="image 7.png" /><br/>
<br/>
Explanation: There is a “b” and a “b ” folder, a file named “a” and a file named “a “, the two default dirs “.” and “..” plus the “. ” and “.. ” ones and the “. .” dir.<br/>
<br/>
Directories with the name “.. ” can be entered with our already discussed technique:<br/>
<br/>
<img src="image 8.png" /><br/>
<br/>
Side note 1: This folder can be opened via the GUI if you click twice on the folder, also the content of the folder will be displayed correctly. However, files in it can’t be opened because of the wrong path (explorer.exe uses C:\test22\.. \.. \123.txt instead of C:\test22\.. \123.txt). Powershell will again be stuck in an endless loop when searching such folders.<br/>
<br/>
Side note 2: You can also create an ADS on a folder with a name such as “abc”. Then you can rename the folder to a name just containing numbers (e.g. “1”). After that you can still see the ADS, but you can’t open it (ADS on a folder with a number as name doesn’t work). To open the ADS data you have to rename the folder first back to for example “abc”.<br/>
<br/>
</body></html>