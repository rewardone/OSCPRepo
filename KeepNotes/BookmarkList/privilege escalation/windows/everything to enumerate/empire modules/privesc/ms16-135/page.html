<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>MS16-135</title>
</head><body>Spawns a new Listener as SYSTEM by leveraging the MS16-135 local exploit. This exploit is for x64 only and only works on unlocked session. Note: the exploit performs fast windows switching, victim\'s desktop may flash. A named pipe is also created. Thus, opsec is not guaranteed'<br/>
Does not need Admin<br/>
<br/>
Credit to TinySec (@TinySecEx) for the initial PoC and',<br/>
'to Ruben Boonen (@FuzzySec) for PowerShell PoC',<br/>
'https://github.com/tinysec/public/tree/master/CVE-2016-7255',<br/>
'https://github.com/FuzzySecurity/PSKernel-Primitives/tree/master/Sample-Exploits/MS16-135',<br/>
'https://security.googleblog.com/2016/10/disclosing-vulnerabilities-to-protect.html<br/>
<br/>
moduleSource = self.mainMenu.installPath + "/data/module_source/privesc/Invoke-MS16135.ps1<br/>
<br/>
MS16-135 Security Bulletin Security Update for Windows Kernel-Mode Drivers<br/>
The most severe of the vulnerabilities could allow elevation of privilege if an attacker logs on to an affected system and runs a specially crafted application that could exploit the vulnerabilities and take control of an affected system. <br/>
<br/>
It can be triggered via the win32k.sys system call NtSetWindowLongPtr() for the index GWLP_ID on a window handle with GWL_STYLE set to WS_CHILD</body></html>