<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Privilege Escalation</title>
</head><body>Linux: For Enumeration scripts, see Tools &gt; Linux Local Enumeration &gt; Auditing and Enumeration<br/>
Windows: For Enumeration scripts, see Tools &gt; Windows Local Enumeration &gt; Auditing and Enumeration<br/>
<br/>
<img src="image.png" /><br/>
<br/>
Linux<br/>
[Its Too Funky In Here04 Linux priv esc for fun profit and mischief Jake Willi](<a href="https://www.youtube.com/watch?v=dk2wsyFiosg">https://www.youtube.com/watch?v=dk2wsyFiosg</a>)<br/>
[Understanding Systemd](https://n0where.net/understanding-systemd)<br/>
<br/>
Windows<br/>
<a href="http://harmj0y.net">http://harmj0y.net</a>&nbsp;&#09;&#09;&#09;&#09;&#09;&#09;Windows (harmj0y = Empire)<br/>
<a href="https://www.youtube.com/watch?v=kMG8IsCohHA">https://www.youtube.com/watch?v=kMG8IsCohHA</a>&nbsp;Encyclopaedia Of Win Priv Escalation (Brett Moore)<br/>
https://web.archive.org/web/20140413142945/docstoc.com/docs/112350262/Windows-Priv-Esc<br/>
<a href="http://www.youtube.com/watch?v=_8xJaaQlpBo">http://www.youtube.com/watch?v=_8xJaaQlpBo</a>&nbsp;DerbyCon 3.0.2105 Windows Attack: AT Is The New Black<br/>
<a href="https://www.youtube.com/watch?v=PC_iMqiuIRQ">https://www.youtube.com/watch?v=PC_iMqiuIRQ</a>&nbsp;Windows, Level Up! Practical Windows Priv Esc<br/>
<br/>
DLL Hijacking<br/>
<a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf">VB.NET Tutorial - Create a DLL / Class Library</a>&nbsp;<br/>
&nbsp;<br/>
Creating a DLL<br/>
<a href="http://www.windowsdevcenter.com/pub/a/windows/2005/04/26/create_dll.html">Create a DLL with Visual Basic</a>&nbsp;<br/>
<a href="https://msdn.microsoft.com/en-us/library/dt232c9t.aspx">Calling DLL Functions from Visual Basic Applications</a>&nbsp;<br/>
<br/>
DLL Injection<br/>
<a href="https://clymb3r.wordpress.com/2013/04/06/reflective-dll-injection-with-powershell/">Reflective DLL Injection with PowerShell - clymb3r</a>&nbsp;| <br/>
<a href="https://blog.cobaltstrike.com/2012/09/17/delivering-custom-payloads-with-metasploit-using-dll-injection/">Delivering custom payloads with Metasploit using DLL injection - blog.cobalstrike</a><br/>
https://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/<br/>
<br/>
http://www.harmj0y.net/blog/activedirectory/targeted-kerberoasting/ | Targeted Kerberoasting<br/>
https://conference.hitb.org/hitbsecconf2017ams/materials/D2T3%20-%20James%20Forshaw%20-%20Introduction%20to%20Logical%20Privilege%20Escalation%20on%20Windows.pdf | Very Technical<br/>
https://blog.xpnsec.com/becoming-system/<br/>
<br/>
OS X <br/>
Privilege Escalation - OS X<ul><li><b>Writeups</b></li>
<li style="list-style-type: none"><ul><li><a href="https://truesecdev.wordpress.com/2015/04/09/hidden-backdoor-api-to-root-privileges-in-apple-os-x/">Hidden backdoor API to root privileges in Apple OS X</a></li>
<li>Works on 10.7 -&gt; 10.10.2</li>
<li><a href="http://randomthoughts.greyhats.it/2014/10/osx-local-privilege-escalation.html">Mac OS X local privilege escalation (IOBluetoothFamily)</a></li>
<li><a href="https://code.google.com/p/google-security-research/issues/detail?id=121">Privilege Escalation on OS X below 10.0</a></li>
<li><a href="http://www.disinfosec.com/2016/10/12/hacking-mac/">Hacking Mac With EmPyre</a></li>
<li><a href="https://developer.apple.com/library/content/technotes/tn2206/_index.html">macOS Code Signing In Depth</a></li>
<li><a href="https://www.n00py.io/2016/10/privilege-escalation-on-os-x-without-exploits/">Privilege escalation on OS X – without exploits - n00py.io</a></li>
<li><a href="https://objective-see.com/blog/blog_0x24.html">Why &lt;blank&gt; Gets You Root</a></li>
<li><a href="https://fuzzynop.blogspot.com/2014/10/osascript-for-local-phishing.html">osascript: for local phishing</a></li>
<li><a href="https://objective-see.com/blog/blog_0x14.html">abusing the local upgrade process to bypass SIP - Objective-see</a></li>
<li><a href="https://lockboxx.blogspot.com/2014/11/native-mac-os-x-application-mach-o.html">Native Mac OS X Application / Mach-O Backdoors for Pentesters</a></li>
<li><a href="https://www.youtube.com/watch?v=9T_2KYox9Us">Attacking OSX for fun and profit tool set limiations frustration and table flipping Dan Tentler - ShowMeCon</a></li>
<li><a href="https://siguza.github.io/IOHIDeous/">IOHIDeous</a></li>
</ul>
</li>
<li><b>Tools</b></li>
<li style="list-style-type: none"><ul><li><a href="https://github.com/Psychotrope37/bigphish">BigPhish</a></li>
<li style="list-style-type: none"><ul><li>This issue has been resolved by Apple in MacOS Sierra by enabling tty_tickets by default. NOTE: All other MacOS operation system (El Capitan, Yosemite, Mavericks etc...) still remain vulnerable to this exploit.</li>
</ul>
</li>
<li><a href="https://github.com/scen/osxinj">osxinj</a></li>
<li style="list-style-type: none"><ul><li>Another dylib injector. Uses a bootstrapping module since mach_inject doesn't fully emulate library loading and crashes when loading complex modules.</li>
</ul>
</li>
<li><a href="https://github.com/scriptjunkie/kcap">kcap</a></li>
<li style="list-style-type: none"><ul><li>This program simply uses screen captures and programmatically generated key and mouse events to locally and graphically man-in-the-middle an OS X password prompt to escalate privileges.</li>
</ul>
</li>
<li><a href="http://www.sveinbjorn.org/platypus">Platypus</a></li>
<li style="list-style-type: none"><ul><li>Platypus is a Mac OS X developer tool that creates native Mac applications from interpreted scripts such as shell scripts or Perl, Ruby and Python programs. This is done by wrapping the script in an application bundle along with a native executable binary that runs the script.</li>
</ul>
</li>
</ul>
</li>
</ul>
&nbsp;<br/>
<br/>
Complete <br/>
Linux<br/>
<a href="http://www.slideshare.net/nullthreat/fund-linux-priv-esc-wprotections">http://www.slideshare.net/nullthreat/fund-linux-priv-esc-wprotections</a><br/>
<a href="http://www.irongeek.com/i.php?page=videos/bsidesaugusta2016/its-too-funky-in-here04-linux-privilege-escalation-for-fun-profit-and-all-around-mischief-jake-williams">http://www.irongeek.com/i.php?page=videos/bsidesaugusta2016/its-too-funky-in-here04-linux-privilege-escalation-for-fun-profit-and-all-around-mischief-jake-williams</a><br/>
[Reach the root](<a href="https://hackmag.com/security/reach-the-root/">https://hackmag.com/security/reach-the-root/</a>) | discusses a process for linux privilege exploitation<br/>
[Basic linux privilege escalation](<a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</a>) | basic linux exploitation, also covers Windows<br/>
http://insidetrust.blogspot.com/2011/04/quick-guide-to-linux-privilege.html<br/>
[Privilege escalation linux with live example](<a href="http://resources.infosecinstitute.com/privilege-escalation-linux-live-examples/">http://resources.infosecinstitute.com/privilege-escalation-linux-live-examples/</a>) | covers a couple common PE methods in linux<br/>
[Local Linux Enumeration &amp; Privilege Escalation Cheatsheet](<a href="https://www.rebootuser.com/?p=1623">https://www.rebootuser.com/?p=1623</a>) | good resources that could be compiled into a script<br/>
<a href="https://www.rebootuser.com/?page_id=1721">https://www.rebootuser.com/?page_id=1721</a><br/>
<a href="http://www.rebootuser.com/?p=1758">http://www.rebootuser.com/?p=1758</a><br/>
[4 Ways get linux privilege escalation](<a href="http://www.hackingarticles.in/4-ways-get-linux-privilege-escalation/">http://www.hackingarticles.in/4-ways-get-linux-privilege-escalation/</a>) | shows different examples of PE scripts<br/>
linux-exploit-suggester, older: <a href="https://github.com/PenturaLabs/Linux_Exploit_Suggester">https://github.com/PenturaLabs/Linux_Exploit_Suggester</a>&nbsp; <br/>
linux-exploit-suggester, updated!: <a href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a>&nbsp; <br/>
mimipenguin, mimicatz ish for linux: <a href="https://github.com/huntergregal/mimipenguin">https://github.com/huntergregal/mimipenguin</a><br/>
<a href="http://netsec.ws/?p=309">http://netsec.ws/?p=309</a>&nbsp;&lt;- just a link to scripts<br/>
<a href="https://github.com/sagishahar/lpeworkshop/blob/master/Lab%20Exercises%20Walkthrough%20-%20Linux.pdf ">https://github.com/sagishahar/lpeworkshop/blob/master/Lab%20Exercises%20Walkthrough%20-%20Linux.pdf </a><br/>
<a href="https://blog.sucuri.net/2013/05/from-a-site-compromise-to-full-root-access-symlinks-to-root-part-i.html">https://blog.sucuri.net/2013/05/from-a-site-compromise-to-full-root-access-symlinks-to-root-part-i.html</a>&nbsp;<br/>
http://rachid.koucha.free.fr/tech_corner/shared_libs_tests.html<br/>
https://blog.compass-security.com/2012/10/dangerous-sudoer-entries-part-1-command-execution/<br/>
https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-2-insecure-functionality/<br/>
https://blog.compass-security.com/2012/10/dangerous-sudoers-entries-part-4-wildcards/<br/>
http://0x90909090.blogspot.fr/2015/07/no-one-expect-command-execution.html<br/>
https://pen-testing.sans.org/resources/papers/gcih/attack-defend-linux-privilege-escalation-techniques-2016-152744<br/>
https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt<br/>
https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2010/february/busybox-command-injection/<br/>
<br/>
Windows<br/>
<a href="https://www.trustwave.com/Resources/SpiderLabs-Blog/My-5-Top-Ways-to-Escalate-Privileges/">https://www.trustwave.com/Resources/SpiderLabs-Blog/My-5-Top-Ways-to-Escalate-Privileges/</a><br/>
[Windows Privilege Escalation](<a href="http://www.bhafsec.com/wiki/index.php/Windows_Privilege_Escalation">http://www.bhafsec.com/wiki/index.php/Windows_Privilege_Escalation</a>) | collection of wiki pages covering Windows Privilege escalation<br/>
<a href="https://github.com/PowerShellMafia/PowerSploit">https://github.com/PowerShellMafia/PowerSploit</a>&nbsp;| In tools section<br/>
<a href="https://github.com/pentestmonkey/windows-privesc-check">https://github.com/pentestmonkey/windows-privesc-check</a>&nbsp; | In tools section<br/>
<a href="https://github.com/foxglovesec/RottenPotato">https://github.com/foxglovesec/RottenPotato</a>&nbsp; | In tools section<br/>
<a href="https://blog.gdssecurity.com/labs/2014/7/11/introducing-windows-exploit-suggester.html">https://blog.gdssecurity.com/labs/2014/7/11/introducing-windows-exploit-suggester.html</a>&nbsp; | In tools section<br/>
[Windows Privilege Escalation Fundamentals](<a href="http://www.fuzzysecurity.com/tutorials/16.html">http://www.fuzzysecurity.com/tutorials/16.html</a>) | collection of great info/tutorials, option to contribute to the creator through patreon, creator is an OSCP (fantastic)<br/>
<a href="http://www.greyhathacker.net/?p=738">http://www.greyhathacker.net/?p=738</a>&nbsp;| Elevating privileges by exploiting weak folder permissions (Parvez Anwar) (fantastic)<br/>
<a href="http://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/">http://www.sploitspren.com/2018-01-26-Windows-Privilege-Escalation-Guide/</a>&nbsp; (fantastic)<br/>
<a href="https://blog.netspi.com/windows-privilege-escalation-part-1-local-administrator-privileges/">https://blog.netspi.com/windows-priv...or-privileges/</a><br/>
<a href="https://blog.netspi.com/windows-privilege-escalation-part-2-domain-admin-privileges/">https://blog.netspi.com/windows-priv...in-privileges/</a><br/>
<a href="http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html">http://it-ovid.blogspot.com/2012/02/windows-privilege-escalation.html</a>&nbsp;- Windows <br/>
<a href="http://www.toshellandback.com/2015/11/24/ms-priv-esc/">www.toshellandback.com/2015/11/24/ms-priv-esc/</a>&nbsp; - Windows (fantastic)<br/>
<a href="http://www.blackhillsinfosec.com/?p=5824">http://www.blackhillsinfosec.com/?p=5824</a>&nbsp; | HostRecon Script information<br/>
<a href="https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/">https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/</a>&nbsp;(fantastic)<br/>
<a href="https://www.commonexploits.com/unquoted-service-paths/ ">https://www.commonexploits.com/unquoted-service-paths/ </a>&nbsp;<br/>
<a href="https://room362.com/post/2011/2011-06-27-fxsstdll-persistence-the-evil-fax-machine/">https://room362.com/post/2011/2011-06-27-fxsstdll-persistence-the-evil-fax-machine/</a>&nbsp;<br/>
<a href="https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/">https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/</a>&nbsp;<br/>
<a href="https://adsecurity.org/?p=2288">https://adsecurity.org/?p=2288</a>&nbsp;<br/>
<a href="http://blogs.technet.com/b/markrussinovich/archive/2006/05/01/the-power-in-power-users.aspx">http://blogs.technet.com/b/markrussinovich/archive/2006/05/01/the-power-in-power-users.aspx</a>&nbsp;(Power Users group)<br/>
<a href="https://hi.cybereason.com/hubfs/Siofra-Research-Tool-Cybereason.pdf?t=1515089088070">https://hi.cybereason.com/hubfs/Siofra-Research-Tool-Cybereason.pdf?t=1515089088070</a>&nbsp;Siofra tool In tools section<br/>
[Windows privilege escalation checker]<a href="https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md">(https://github.com/netbiosX/Checklists/blob/master/Windows-Privilege-Escalation.md</a>) | a list of topics that link to pentestlab.blog, all related to windows privilege escalation In tools section<br/>
<a href="https://pentestlab.blog/2017/03/27/dll-hijacking/">https://pentestlab.blog/2017/03/27/dll-hijacking/</a>&nbsp;<br/>
<a href="http://www.tarasco.org/">http://www.tarasco.org/</a>&nbsp; <br/>
<a href="https://github.com/sagishahar/lpeworkshop/blob/master/Local%20Privilege%20Escalation%20Workshop%20-%20Slides.pdf">https://github.com/sagishahar/lpeworkshop/blob/master/Local%20Privilege%20Escalation%20Workshop%20-%20Slides.pdf</a>&nbsp;(fantastic) <br/>
<a href="http://windowsitpro.com/windows/netexe-reference">Net.exe reference</a><br/>
<a href="https://technet.microsoft.com/en-us/library/cc732952.aspx">Dsquery - technet</a><br/>
<a href="https://gallery.technet.microsoft.com/scriptcenter/Get-Active-Window-on-User-352fa957">Get Active Window on User Desktop - technet</a>&nbsp;This script will tell you the application that user is currently using. This also called active window. This script replies on unmanaged dll, user32.dll, to get this information. It has a function called GetForegroundWindow() which returns the Windowhandle of the active process.<br/>
<a href="https://www.vexasoft.com/pages/get-window">Get-Window</a>&nbsp;Gets the application windows that are open on the local desktop.<br/>
<a href="https://www.reddit.com/r/PowerShell/comments/2onpdm/get_active_window_titles_of_remote_computer/">Get Active Window titles of remote computer? - reddit</a><br/>
<a href="https://stackoverflow.com/questions/191206/how-to-get-list-of-running-applications-using-powershell-or-vbscript">How to get list of running applications using PowerShell or VBScript</a><br/>
<a href="https://www.darkoperator.com/blog/2013/1/31/introduction-to-wmi-basics-with-powershell-part-1-what-it-is.html">Introduction to WMI Basics with PowerShell Part 1 (What it is and exploring it with a GUI)</a>&nbsp;(In UsefulCommands primer)<br/>
<a href="http://poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html">Playing with MOF files on Windows, for fun &amp; profit</a>&nbsp;<br/>
<a href="https://github.com/gdedrouas/Exchange-AD-Privesc">https://github.com/gdedrouas/Exchange-AD-Privesc</a><br/>
<a href="https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html">https://byt3bl33d3r.github.io/practical-guide-to-ntlm-relaying-in-2017-aka-getting-a-foothold-in-under-5-minutes.html</a><br/>
<a href="https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/">https://www.fox-it.com/en/insights/blogs/blog/inside-windows-network/</a><br/>
<a href="https://hausec.com/2017/10/25/automating-the-pentesting-process-how-llmnr-spoofing-can-lead-to-domain-admin-in-5-minutes/">https://hausec.com/2017/10/25/automating-the-pentesting-process-how-llmnr-spoofing-can-lead-to-domain-admin-in-5-minutes/</a><br/>
<a href="https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/">https://blog.fox-it.com/2018/04/26/escalating-privileges-with-acls-in-active-directory/</a><br/>
“I Hunt Sys Admins” - Harmjoy <br/>
<a href="https://www.slideshare.net/harmj0y/i-hunt-sys-admins">https://www.slideshare.net/harmj0y/i-hunt-sys-admins</a>&nbsp;<br/>
https://winscripting.blog/2017/05/12/first-entry-welcome-and-uac-bypass/<br/>
https://tyranidslair.blogspot.co.uk/2017/08/the-art-of-becoming-trustedinstaller.html<br/>
<a href="https://msdn.microsoft.com/en-US/library/ms682586">Dynamic-Link Library Search Order</a>&nbsp;|<br/>
<a href="https://msdn.microsoft.com/en-us/library/aa375365">Manifests - MSDN</a>&nbsp;| <br/>
<a href="https://www.fireeye.com/blog/threat-research/2014/04/dll-side-loading-another-blind-spot-for-anti-virus.html">DLL Side-Loading: Another Blind-Spot for Anti-Virus - FireEye</a>&nbsp;| <br/>
<a href="https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-dll-sideloading.pdf">DLL Side-Loading: A Thorn in the Side of the Anti-Virus Industry - pdf</a>&nbsp;|<br/>
<a href="https://github.com/veramine/Detections/wiki/DLL-Side-Loading">DLL Side Loading - veramine detections</a>&nbsp;| <br/>
<a href="https://support.microsoft.com/en-us/help/2389418/secure-loading-of-libraries-to-prevent-dll-preloading-attacks">Secure loading of libraries to prevent DLL preloading attacks - MSDN</a>&nbsp;| <br/>
<a href="https://www.exploit-db.com/docs/31687.pdf">Dynamic-Link Library Hijacking</a>&nbsp;| <a href="https://web.archive.org/web/20160407094753/www.exploit-db.com/docs/31687.pdf">archive</a>&nbsp;| <br/>
<a href="https://blog.fortinet.com/2015/12/10/a-crash-course-in-dll-hijacking">Crash Course in DLL Hijacking</a>&nbsp;| <br/>
<a href="http://securityxploded.com/dll-injection-and-hooking.php">DLL Injection and Hooking</a>&nbsp;| <br/>
<a href="http://blog.opensecurityresearch.com/2013/01/windows-dll-injection-basics.html">Windows DLL Injection Basics</a>&nbsp;| <br/>
<a href="https://blog.fortinet.com/2015/12/10/a-crash-course-in-dll-hijacking">Crash Course in DLL Hijacking</a>&nbsp;| <br/>
<a href="https://disman.tl/2015/01/30/an-improved-reflective-dll-injection-technique.html">An Improved Reflective DLL Injection Technique - Dan Staples</a>&nbsp;|<br/>
http://securityxploded.com/ntcreatethreadex.php |<br/>
http://syprog.blogspot.com/2012/05/createremotethread-bypass-windows.html<br/>
<a href="http://blog.deniable.org/blog/2017/07/16/inject-all-the-things/">Inject All the Things - Shutup and Hack</a>&nbsp;- <a href="https://github.com/fdiskyou/injectAllTheThings">Code - Github</a>&nbsp;| Amazing<br/>
https://github.com/stephenfewer/ReflectiveDLLInjection | The original reflective technique<br/>
https://adsecurity.org/?p=676 | ms14-068<br/>
https://www.trustedsec.com/2014/12/ms14-068-full-compromise-step-step/ | ms14-068<br/>
http://adsecurity.org/?p=525 | ms14-068<br/>
http://adsecurity.org/?p=541 | ms14-068<br/>
http://adsecurity.org/?p=763 | ms14-068<br/>
http://carnal0wnage.attackresearch.com/2012/10/group-policy-preferences-and-getting.html | GPP-Passwords<br/>
https://web.archive.org/web/20160413141758/leonteale.co.uk/decrypting-windows-2008-gpp-user-passwords-using-gpprefdecrypt-py/ | Archive. GPP-Passwords<br/>
http://www.labofapenetrationtester.com/2015/05/dumping-passwords-in-plain-on-windows-8-1.html | WDigest registry<br/>
https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows | DLL AtomBombing injection<br/>
https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows<br/>
https://github.com/BreakingMalwareResearch/atom-bombing<br/>
https://adsecurity.org/?p=2362 | amazing information about gaining domain admin, routes to escalation, etc<br/>
https://sec-consult.com/en/blog/2018/06/pentesters-windows-ntfs-tricks-collection/<br/>
https://github.com/l0ss/Get-GPTrashfire/ | Group Policy Escalation Stuff<br/>
http://blakhal0.blogspot.com/2012/08/hiding-files-by-exploiting-spaces-in.html<br/>
https://labs.mwrinfosecurity.com/blog/trust-years-to-earn-seconds-to-break/ | S4U2Self and Kerberos<br/>
https://www.slideshare.net/mubix/windows-attacks-at-is-the-new-black-26665607 | Various<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>