<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body>https://github.com/Cybereason/Invoke-WMILM<br/>
<br/>
Invoke-WMILM<br/>
This is a PoC script for various methods to acheive authenticated remote code execution via WMI, without (at least directly) using the Win32_Process class. The type of technique is determined by the "Type" parameter.<br/>
<br/>
Parameters<ul><li style="list-style-type: none">Target - Name or IP of target machine</li>
<li style="list-style-type: none">Type - The type of technique to use</li>
<li style="list-style-type: none">Name - For techniques creating named objects (services, tasks etc.)</li>
<li style="list-style-type: none">Command - Executable to run</li>
<li style="list-style-type: none">CommandArgs - Arguments to the executable</li>
<li style="list-style-type: none">CleanUp - an optional phase to remove artifacts created by the various techniques</li>
<li style="list-style-type: none">Username</li>
<li style="list-style-type: none">Password</li>
</ul>
<br/>
Supported Techniques<ul><li style="list-style-type: none">DerivedProcess - Creates a class deriving from Win32_Process, and calls the Create method of that class</li>
<li style="list-style-type: none">Service - Creates a service and runs it using WMI. Basically PSEXEC with different network traffic</li>
<li style="list-style-type: none">Job - Creates an at.exe style scheduled task to run in 30 seconds. Does not work on Win8+, unless at.exe is enabled</li>
<li style="list-style-type: none">Task - Creates an schtasks.exe style scheduled task and runs it. Works only on Win8+</li>
<li style="list-style-type: none">Product - Runs an arbitrary MSI file from a given path (given by the Command parameter)</li>
<li style="list-style-type: none">Provider - Creates a new provider with the command and arguments as the underlying COM object, and loads it</li>
</ul>
</body></html>