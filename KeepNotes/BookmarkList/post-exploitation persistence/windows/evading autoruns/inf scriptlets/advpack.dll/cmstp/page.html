<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>CMSTP</title>
</head><body>CMSTP.exe will probably be documented more in depth somewhere else, but you can use it to launch SCT files<br/>
See also Privilege Escalation &gt; Windows &gt; UAC Bypass &gt; <a href="nbk:///fc1c23b9-2ef4-4932-894f-1b8f7e8a8469">CMSTP</a><br/>
<br/>
Under the hood, CMSTP leverages Advpack.dll and a variant of LaunchINFSection<br/>
<br/>
cmstp.exe /s cmstp.inf<br/>
<br/>
INF calls SCT<br/>
cmstp calls INF 'DefaultInstall_SingleUser'<br/>
DefaultInstall_SingleUser calls OCX unregister directive<br/>
UnRegisterOCX calls UnRegisterOCXSection<br/>
UnRegisterOCXSection calls scrobj.dll, fetch, run SCT<br/>
<br/>
<br/>
Here is some early bad cmstp.exe from 2013:<br/>
&nbsp;&lt;cabextract&gt;\cmstp.exe KKVPN.inf<br/>
&nbsp;Uploaded 2013-08-27: https://www.virustotal.com/#/file/e06d3a8ecb65ddcb82d67993bab36ead108804bfcb89cebcf4712f28b21a669f/detection<br/>
<br/>
Here's malicious cmstp.exe with /s argument from 2014:<br/>
&nbsp;cmstp.exe /s %TEMP%\_vp\Briz_VPN.inf<br/>
&nbsp;Uploaded 2014-09-03: https://www.virustotal.com/#/file/eac894dd854367c21839fe02a3b298f4f81bfca015e5d6acb025eed9b20b3a09/details<br/>
<br/>
</body></html>