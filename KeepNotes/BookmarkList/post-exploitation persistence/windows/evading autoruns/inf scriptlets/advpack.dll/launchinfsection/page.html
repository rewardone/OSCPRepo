<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>LaunchINFSection</title>
</head><body>According to Microsoft <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/platform-apis/gg441316(v=vs.85)">documentation</a>, LaunchINFSection is a method within the Advanced INF Package Installer (advpack.dll) that is used to invoke a particular section within a setup information (.inf) file. &nbsp;In the administrative sense, INF files are typically used as an instruction file for the installation of device drivers and/or Windows Cabinet (.cab) files, which may include registering Windows binaries (exe, dll, ocx), adding keys to the registry, and/or specifying critical parameter settings. &nbsp;The general method for LaunchINFSection invocation is as follows:<br/>
<br/>
rundll32.exe advpack.dll,LaunchINFSection [file].inf,[INF Section],[Path to Cab].cab,[Installation Flags]<br/>
<br/>
If the [INF Section] is not specified, LaunchINFSection will attempt to call DefaultInstall for the default section. &nbsp;Additionally, it is worth noting that the Advanced INF Package Installer also contains the function LaunchINFSectionEx as well as other character set comparability functions (e.g. LaunchINFSectionA), which effectively do the same thing as LaunchINFSection.<br/>
<br/>
rundll32.exe advpack.dll,LaunchINFSection test.inf,DefaultInstall_SingleUser,1,<br/>
<br/>
Take note that we can also launch our payload in other, slightly different ways. &nbsp;If we change the INF file entry point section to ‘DefaultInstall’, (ie [DefaultInstall_SingleUser] to just [DefaultInstall]) we can launch our payload without section specification using the following command:<br/>
<br/>
rundll32.exe advpack.dll,LaunchINFSection test.inf,,1,<br/>
<br/>
Additionally, we can change the OCX unregister directive to a register directive (‘RegisterOCXs’) and supply a random name (e.g. ‘MoreFun’) to invoke the same payload:<br/>
<br/>
LaunchINFSection proves to be a valid application whitelisting bypass technique as we were able to “gain code execution” against <a href="https://oddvar.moe/2017/12/13/applocker-case-study-how-insecure-is-it-really-part-1/">default</a>&nbsp;AppLocker rules.</body></html>