<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Primer</title>
</head><body><a href="https://adsecurity.org/?p=1632">Presented at Def Con 23 (2015)</a>&nbsp;<br/>
<br/>
Directory Restore Mode Account<br/>
Every Domain Controller has an internal "Break glass" local administrator account to DC called the Directory Services Restore Mode (DSRM) account. DSRM password set when DC is promoted and rarely changed. Primary method to change the DSRM password on a Domain Controller invovles running the ntdsutil command line tool. <br/>
<br/>
Beginning with hotfix <a href="http://support.microsoft.com/kb/961320">KB961320</a>&nbsp;on Server 2008, There is now the option to synchronize the DSRM password on a DC with a specific domain account. Note that this must be performed every time the password is changed. It does nto create an automatic sync parternship. <br/>
<br/>
Conclusion<br/>
<br/>
If an attacker can gain knowledge of the DSRM account password on a Domain Controller running Windows Server 2008 R2 or 2012 R2 (with the DsrmAdminLogonBehavior regkey set to 2), the DSRM account can be used to authenticate across the network via pass-the-hash to the DC (forcing NTLM authentication). This enables an attacker to retain Domain Controller admin rights when all domain user and computer passwords are changed.<br/>
<br/>
The DSRM account now provides a useful attack method to pull domain credentials, despite the fact it’s a “local” administrator account.</body></html>