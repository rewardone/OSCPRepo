<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Discovery</title>
</head><body>Discovery<br/>
<br/>
Tactic Description<br/>
Discovery consists of techniques that allow the adversary to gain knowledge about the system and internal network. When adversaries gain access to a new system, they must orient themselves to what they now have control of and what benefits operating from that system give to their current objective or overall goals during the intrusion. The operating system provides many native tools that aid in this post-compromise information-gathering phase.<br/>
<br/>
Techniques<br/>
Below is a list of all the Discovery techniques in enterprise:<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1087">Account Discovery</a>&nbsp;<br/>
Adversaries may attempt to get a listing of local system or domain accounts.<br/>
<b>Windows</b><br/>
Example commands that can acquire this information are net user, net group &lt;groupname&gt;, and net localgroup &lt;groupname&gt; using the Net utility or through use of dsquery. If adversaries attempt to identify the primary user, currently logged in user, or set of users that commonly uses a system, System Owner/User Discovery may apply.<br/>
<br/>
<b>Mac</b><br/>
On Mac, groups can be enumerated through the groups and id commands. In mac specifically, dscl . list /Groups and dscacheutil -q group can also be used to enumerate groups and users.<br/>
<br/>
<b>Linux</b><br/>
On Linux, local users can be enumerated through the use of the /etc/passwd file which is world readable. In mac, this same file is only used in single-user mode in addition to the /etc/master.passwd file.<br/>
<br/>
Also, groups can be enumerated through the groups and id commands. In mac specifically, dscl . list /Groups and dscacheutil -q group can also be used to enumerate groups and users.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1010">Application Window Discovery</a>&nbsp;<br/>
Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used or give context to information collected by a keylogger. In Mac, this can be done natively with a small AppleScript script.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1217">Browser Bookmark Discovery</a>&nbsp;<br/>
Adversaries may enumerate browser bookmarks to learn more about compromised hosts. Browser bookmarks may reveal personal information about users (ex: banking sites, interests, social media, etc.) as well as details about internal network resources such as servers, tools/dashboards, or other related infrastructure.<br/>
Browser bookmarks may also highlight additional targets after an adversary has access to valid credentials, especially Credentials in Files associated with logins cached by a browser.<br/>
<br/>
Specific storage locations vary based on platform and/or application, but browser bookmarks are typically stored in local files/databases.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1083">File and Directory Discovery</a>&nbsp;<br/>
Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system.<br/>
<br/>
<b>Windows</b><br/>
Example utilities used to obtain this information are dir and tree.1 Custom tools may also be used to gather file and directory information and interact with the Windows API.<br/>
<b><br/>
</b><b>Mac and Linux</b><br/>
In Mac and Linux, this kind of discovery is accomplished with the ls, find, and locate commands.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1046">Network Service Scanning</a>&nbsp;<br/>
Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans using tools that are brought onto a system.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1135">Network Share Discovery</a>&nbsp;<br/>
Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network.<br/>
<br/>
<b>Windows</b><br/>
File sharing over a Windows network occurs over the SMB protocol.23<br/>
<br/>
Net can be used to query a remote system for available shared drives using the net view \\remotesystem command. It can also be used to query shared drives on the local system using net share.<br/>
<br/>
Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement.<br/>
<br/>
<b>Mac</b><br/>
On Mac, locally mounted shares can be viewed with the df -aH command.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1201">Password Policy Discovery</a>&nbsp;<br/>
Password policies for networks are a way to enforce complex passwords that are difficult to guess or crack through Brute Force. An adversary may attempt to access detailed information about the password policy used within an enterprise network. This would help the adversary to create a list of common passwords and launch dictionary and/or brute force attacks which adheres to the policy (e.g. if the minimum password length should be 8, then not trying passwords such as 'pass123'; not checking for more than 3-4 passwords per account if the lockout is set to 6 as to not lock out accounts).<br/>
Password policies can be set and discovered on Windows, Linux, and macOS systems.45<br/>
<br/>
<b>Windows</b><ul><li>net accounts</li>
<li>net accounts /domain</li>
</ul>
<br/>
<b>Linux</b><ul><li>chage -l &lt;username&gt;</li>
<li>cat /etc/pam.d/common-password</li>
</ul>
<br/>
<b>macOS</b><ul><li>pwpolicy getaccountpolicies</li>
</ul>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1120">Peripheral Device Discovery</a>&nbsp;<br/>
Adversaries may attempt to gather information about attached peripheral devices and components connected to a computer system. The information may be used to enhance their awareness of the system and network environment or may be used for further actions<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1069">Permission Groups Discovery</a>&nbsp;<br/>
Adversaries may attempt to find local system or domain-level groups and permissions settings<br/>
.<br/>
<b>Windows</b><br/>
Examples of commands that can list groups are net group /domain and net localgroup using the Net utility.<br/>
<br/>
<b>Mac</b><br/>
On Mac, this same thing can be accomplished with the dscacheutil -q group for the domain, or dscl . -list /Groups for local groups.<br/>
<br/>
<b>Linux</b><br/>
On Linux, local groups can be enumerated with the groups command and domain groups via the ldapsearch command.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1057">Process Discovery</a>&nbsp;<br/>
Adversaries may attempt to get information about running processes on a system. Information obtained could be used to gain an understanding of common software running on systems within the network.<br/>
<br/>
<b>Windows</b><br/>
An example command that would obtain details on processes is "tasklist" using the Tasklist utility.<br/>
<br/>
<b>Mac and Linux</b><br/>
In Mac and Linux, this is accomplished with the ps command.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1012">Query Registry</a>&nbsp;<br/>
Adversaries may interact with the Windows Registry to gather information about the system, configuration, and installed software. The Registry contains a significant amount of information about the operating system, configuration, software, and security.6 Some of the information may help adversaries to further their operation within a network.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1018">Remote System Discovery</a>&nbsp;<br/>
Adversaries will likely attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used.<br/>
<br/>
<b>Windows</b><br/>
Examples of tools and commands that acquire this information include "ping" or "net view" using Net.<br/>
<br/>
<b>Mac</b><br/>
Specific to Mac, the bonjour protocol to discover additional Mac-based systems within the same broadcast domain. Utilities such as "ping" and others can be used to gather information about remote systems.<br/>
<br/>
<b>Linux</b><br/>
Utilities such as "ping" and others can be used to gather information about remote systems.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1063">Security Software Discovery</a>&nbsp;<br/>
Adversaries may attempt to get a listing of security software, configurations, defensive tools, and sensors that are installed on the system. This may include things such as local firewall rules, anti-virus, and virtualization. These checks may be built into early-stage remote access tools.<br/>
<br/>
<b>Windows</b><br/>
Example commands that can be used to obtain security software information are netsh, reg query with Reg, dir with cmd, and Tasklist, but other indicators of discovery behavior may be more specific to the type of software or security system the adversary is looking for.<br/>
<br/>
<b>Mac</b><br/>
It's becoming more common to see macOS malware perform checks for LittleSnitch and KnockKnock software.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1082">System Information Discovery</a>&nbsp;<br/>
An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture.<br/>
<br/>
<b>Windows</b><br/>
Example commands and utilities that obtain this information include ver, Systeminfo, and dir within cmd for identifying information based on present files and directories.<br/>
<br/>
<b>Mac</b><br/>
On Mac, the systemsetup command gives a detailed breakdown of the system, but it requires administrative privileges. Additionally, the system_profiler gives a very detailed breakdown of configurations, firewall rules, mounted volumes, hardware, and many other things without needing elevated permissions.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1016">System Network Configuration Discovery</a>&nbsp;<br/>
Adversaries will likely look for details about the network configuration and settings of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include Arp, ipconfig/ifconfig, nbtstat, and route.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1049">System Network Connections Discovery</a>&nbsp;<br/>
Adversaries may attempt to get a listing of network connections to or from the compromised system they are currently accessing or from remote systems by querying for information over the network.<br/>
<br/>
<b>Windows</b><br/>
Utilities and commands that acquire this information include netstat, "net use," and "net session" with Net.<br/>
<b><br/>
</b><b>Mac and Linux</b><br/>
In Mac and Linux, netstat and lsof can be used to list current connections. who -a and w can be used to show which users are currently logged in, similar to "net session".<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1033">System Owner/User Discovery</a>&nbsp;<br/>
<b>Windows </b><br/>
Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using Credential Dumping. The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs.<br/>
<br/>
<b>Mac</b><br/>
On Mac, the currently logged in user can be identified with users,w, and who.<br/>
<br/>
<b>Linux</b><br/>
On Linux, the currently logged in user can be identified with w and who.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1007">System Service Discovery</a>&nbsp;<br/>
Adversaries may try to get information about registered services. Commands that may obtain information about services using operating system utilities are "sc," "tasklist /svc" using Tasklist, and "net start" using Net, but adversaries may also use other tools as well.<br/>
<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1124">System Time Discovery</a>&nbsp;<br/>
The system time is set and stored by the Windows Time Service within a domain to maintain time synchronization between systems and services in an enterprise network.78 An adversary may gather the system time and/or time zone from a local or remote system. This information may be gathered in a number of ways, such as with Net on Windows by performing net time \\hostname to gather the system time on a remote system. The victim's time zone may also be inferred from the current system time or gathered by using w32tm /tz.8 The information could be useful for performing other techniques, such as executing a file with a Scheduled Task9, or to discover locality information based on time zone to assist in victim targeting.</body></html>